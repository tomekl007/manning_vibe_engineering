"db_id","difficulty","question","expected","actual","overlap_similarity"
"california_schools","simple","What is the highest eligible free rate for K-12 students in the schools in Alameda County?","SELECT `FRPM Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`FRPM Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1","SELECT MAX(f.NSLP_Provision_Status) AS Highest_Free_Rate FROM frpm AS f JOIN schools AS s ON f.CDSCode=s.CDSCode WHERE f.County_Name='Alameda' AND f.School_Type='K-12';","0.23529411764705882"
"california_schools","moderate","Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.","SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3","SELECT DISTINCT T1.SchoolName, T1.NSLP_Provision_Status FROM frpm AS T1 WHERE T1.School_Type='Continuation' AND T1.NSLP_Provision_Status='Free' ORDER BY T1.NSLP_Provision_Status LIMIT 3;","0.2222222222222222"
"california_schools","simple","Please list the zip code of all the charter schools in Fresno County Office of Education.","SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1","SELECT s.Zip FROM schools AS s WHERE s.County='Fresno' AND s.Charter=1;","0.3157894736842105"
"california_schools","simple","What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?","SELECT T2.MailStreet FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 1","SELECT s.MailStreet, s.MailCity, s.MailZip, s.MailState FROM frpm AS f JOIN schools AS s ON f.CDSCode=s.CDSCode WHERE f.""Academic Year""='K-12' ORDER BY f.""FRPM Count"" DESC LIMIT 1;","0.47058823529411764"
"california_schools","moderate","Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.","SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'","SELECT Phone FROM schools WHERE Charter=1 AND OpenDate>'2000-01-01';","0.3888888888888889"
"california_schools","simple","How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?","SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400","SELECT COUNT(*) FROM frpm AS f JOIN satscores AS s ON f.CDSCode=s.cds JOIN schools AS sch ON f.CDSCode=sch.CDSCode WHERE s.AvgScrMath<400 AND sch.Virtual='Y';","0.5333333333333333"
"california_schools","simple","Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.","SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500","SELECT s.""School Name"" FROM ""satscores"" AS sat INNER JOIN ""schools"" AS s ON sat.cds=s.CDSCode WHERE sat.NumTstTakr>500 AND s.""Magnet""=1;","0.6428571428571429"
"california_schools","simple","What is the phone number of the school that has the highest number of test takers with an SAT score of over 1500?","SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1","SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T1.NumGE1500=(SELECT MAX(NumGE1500) FROM satscores) LIMIT 1;","0.9"
"california_schools","simple","What is the number of SAT test takers of the schools with the highest FRPM count for K-12 students?","SELECT NumTstTakr FROM satscores WHERE cds = ( SELECT CDSCode FROM frpm ORDER BY `FRPM Count (K-12)` DESC LIMIT 1 )","SELECT SUM(s.NumTstTakr) AS Total_SAT_Takers FROM satscores s JOIN frpm f ON s.cds=f.CDSCode WHERE f.""Academic Year""='K-12' AND f.""CDSCode"" IN ( SELECT f2.""CDSCode"" FROM frpm f2 GROUP BY f2.""CDSCode"" ORDER BY COUNT(*) DESC LIMIT 1 );","0.6"
"california_schools","simple","Among the schools with the average score in Math over 560 in the SAT test, how many schools are directly charter-funded?","SELECT COUNT(T2.`School Code`) FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath > 560 AND T2.`Charter Funding Type` = 'Directly funded'","SELECT COUNT(*) FROM ( SELECT s.CDSCode FROM satscores AS ss INNER JOIN schools AS s ON ss.cds=s.CDSCode WHERE ss.AvgScrMath>560 AND s.Charter=1 ) AS charter_schools;","0.3"
"california_schools","simple","For the school with the highest average score in Reading in the SAT test, what is its FRPM count for students aged 5-17?","SELECT T2.`FRPM Count (Ages 5-17)` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrRead DESC LIMIT 1","SELECT F.""School Name"", F.""FRPM Count"" FROM ( SELECT S.""School Name"", F.""FRPM Count"" FROM frpm AS F JOIN schools AS S ON F.""School Code""=S.""CDSCode"" WHERE F.""Academic Year""='2023' AND F.""County Code"" IS NOT NULL ) AS F JOIN ( SELECT T1.cds, AVG(T1.AvgScrRead) AS AvgReadScore FROM satscores AS T1 GROUP BY T1.cds ORDER BY AvgReadScore DESC LIMIT 1 ) AS T ON F.""School Code""=T.cds WHERE F.""Academic Year""='2023' AND F.""County Code"" IS NOT NULL;","0.3333333333333333"
"california_schools","simple","Please list the codes of the schools with a total enrollment of over 500.","SELECT T2.CDSCode FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` + T2.`Enrollment (Ages 5-17)` > 500","SELECT s.CDSCode FROM satscores AS s WHERE s.enroll12>500;","0.13333333333333333"
"california_schools","moderate","Among the schools with an SAT excellence rate of over 0.3, what is the highest eligible free rate for students aged 5-17?","SELECT MAX(CAST(T1.`Free Meal Count (Ages 5-17)` AS REAL) / T1.`Enrollment (Ages 5-17)`) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr > 0.3","SELECT MAX(f.""Eligible Free Rate"") AS HighestEligibleFreeRate FROM frpm AS f JOIN satscores AS s ON f.CDSCode=s.cds WHERE s.NumGE1500/s.NumTstTakr>0.3 AND f.""Academic Year""='2023'--Assuming we are looking for the most recent academic year AND f.""School Type""='Public'--Assuming we are interested in public schools AND f.""Educational Option Type""='Free' AND f.""Age Group""='5-17';--Assuming there is a column for age group in the frpm table","0.24444444444444444"
"california_schools","simple","Please list the phone numbers of the schools with the top 3 SAT excellence rate.","SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr DESC LIMIT 3","SELECT S.Phone FROM satscores AS SS INNER JOIN schools AS S ON SS.cds=S.CDSCode ORDER BY (SS.NumGE1500*1.0/SS.NumTstTakr) DESC LIMIT 3;","0.6"
"california_schools","simple","List the top five school, by descending order, from the highest to the lowest, the most number of Enrollment (Ages 5-17). Please give their NCES school identification number.","SELECT T1.NCESSchool FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.`Enrollment (Ages 5-17)` DESC LIMIT 5","SELECT S.NCESSchool, S.School, SUM(SA.enroll12) AS TotalEnrollment FROM schools AS S JOIN satscores AS SA ON S.CDSCode=SA.cds WHERE SA.enroll12 IS NOT NULL GROUP BY S.NCESSchool, S.School ORDER BY TotalEnrollment DESC LIMIT 5;","0.2777777777777778"
"california_schools","simple","Which active district has the highest average score in Reading?","SELECT T1.District FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Active' ORDER BY T2.AvgScrRead DESC LIMIT 1","SELECT s.""District Name"", AVG(ss.""AvgScrRead"") AS avg_reading_score FROM ""satscores"" AS ss INNER JOIN ""schools"" AS s ON ss.cds=s.CDSCode WHERE s.""StatusType""='Active' GROUP BY s.""District Name"" ORDER BY avg_reading_score DESC LIMIT 1;","0.625"
"california_schools","simple","How many schools in merged Alameda have number of test takers less than 100?","SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Merged' AND T2.NumTstTakr < 100 AND T1.County = 'Alameda'","SELECT COUNT(*) AS SchoolCount FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T2.County='Alameda' AND T1.NumTstTakr<100;","0.7692307692307693"
"california_schools","simple","What is the charter number of the school that the average score in Writing is 499?","SELECT T1.CharterNum FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.AvgScrWrite = 499","SELECT s.""CharterNum"" FROM ""satscores"" AS ss JOIN ""schools"" AS s ON ss.cds=s.""CDSCode"" WHERE ss.""AvgScrWrite""=499;","0.6363636363636364"
"california_schools","simple","How many schools in Contra Costa (directly funded) have number of test takers not more than 250?","SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`County Name` = 'Contra Costa' AND T2.NumTstTakr <= 250","SELECT COUNT(*) AS SchoolCount FROM schools AS s JOIN satscores AS t ON s.CDSCode=t.cds WHERE s.County='Contra Costa' AND s.FundingType='Directly Funded' AND t.NumTstTakr<=250;","0.45454545454545453"
"california_schools","simple","What is the phone number of the school that has the highest average score in Math?","SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1","SELECT s.Phone FROM schools s JOIN satscores ss ON s.CDSCode=ss.cds WHERE ss.AvgScrMath=(SELECT MAX(AvgScrMath) FROM satscores) LIMIT 1;","0.5833333333333334"
"california_schools","simple","How many schools in Amador which the Low Grade is 9 and the High Grade is 12?","SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12","SELECT COUNT(*) AS SchoolCount FROM schools WHERE County='Amador' AND GSserved='9-12';","0.3125"
"california_schools","simple","In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12?","SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `Free Meal Count (K-12)` < 700","SELECT COUNT(*) AS SchoolCount FROM frpm WHERE County Name='Los Angeles' AND ""Free Meals"">500 AND ""Free or Reduced Price Meals""<700;","0.5"
"california_schools","simple","Which school in Contra Costa has the highest number of test takers?","SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1","SELECT T3.""School Name"", SUM(T2.""NumTstTakr"") AS TotalTestTakers FROM ""frpm"" AS T1 INNER JOIN ""satscores"" AS T2 ON T1.""CDSCode""=T2.""cds"" INNER JOIN ""schools"" AS T3 ON T1.""CDSCode""=T3.""CDSCode"" WHERE T1.""County Name""='Contra Costa' GROUP BY T3.""School Name"" ORDER BY TotalTestTakers DESC LIMIT 1;","0.3157894736842105"
"california_schools","moderate","List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools.","SELECT T1.School, T1.StreetAbr FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30","SELECT s.""School Name"", s.""Street"", s.""City"", s.""Zip"", s.""State"" FROM ""satscores"" AS ss JOIN ""schools"" AS s ON ss.cds=s.""CDSCode"" WHERE ABS(ss.enroll12-ss.enroll5to17)>30;","0.15384615384615385"
"california_schools","moderate","Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500?","SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0","SELECT s.""School Name"" FROM frpm AS f JOIN satscores AS t ON f.""CDSCode""=t.cds JOIN schools AS s ON f.""CDSCode""=s.""CDSCode"" WHERE f.""Percent Eligible for Free Meals"">0.1 AND t.""NumGE1500"">0","0.4166666666666667"
"california_schools","moderate","Name elementary schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools?","SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400","SELECT s.""School Name"", s.""FundingType"" FROM ""frpm"" AS f JOIN ""satscores"" AS sat ON f.""CDSCode""=sat.""cds"" JOIN ""schools"" AS s ON f.""CDSCode""=s.""CDSCode"" WHERE f.""County Name""='Riverside' AND s.""School Type""='Elementary' GROUP BY s.""School Name"", s.""FundingType"" HAVING AVG(sat.""AvgScrMath"")>400;","0.391304347826087"
"california_schools","moderate","State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17?","SELECT T1.`School Name`, T2.Zip, T2.Street, T2.City, T2.State FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'","SELECT s.""School Name"", s.""Street"", s.""City"", s.""Zip"", s.""State"" FROM ""frpm"" AS f JOIN ""schools"" AS s ON f.""CDSCode""=s.""CDSCode"" WHERE f.""County Name""='Monterey' AND f.""Academic Year""='2023' AND f.""School Type""='High School' AND f.""Free or Reduced Price Meals"">800 AND f.""Age Group""='15-17';","0.48484848484848486"
"california_schools","moderate","What is the average score in writing for the schools that were opened after 1991 and closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any.","SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM satscores AS T1 RIGHT JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) >= 1991 OR strftime('%Y', T2.ClosedDate) < 2000","SELECT s.""School Name"", AVG(ss.""AvgScrWrite"") AS ""Average Writing Score"", s.""Phone"" AS ""Communication Number"" FROM ""schools"" s JOIN ""satscores"" ss ON s.""CDSCode""=ss.""cds"" WHERE s.""OpenDate"">'1991-01-01' AND s.""ClosedDate""<'2000-01-01' GROUP BY s.""School Name"", s.""Phone""","0.4583333333333333"
"california_schools","challenging","Find the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded? List the names, K-12 enrollment, and 15-17 enrollment of schools which has a difference above this average.","SELECT AVG(T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`), T2.School, T1.`Enrollment (K-12)` , T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND T1.`Enrollment (K-12)` + T1.`Enrollment (Ages 5-17)` > ( SELECT CAST((SUM(T2.`Enrollment (K-12)`) + SUM(T2.`Enrollment (Ages 5-17)`)) AS REAL) / COUNT(*) FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.FundingType = 'Locally funded' ) GROUP BY T2.School, T1.`Enrollment (K-12)`, T1.`Enrollment (Ages 5-17)`","WITH EnrollmentDifferences AS ( SELECT s.""School Name"", ss.""enroll12"" AS K12_enrollment, ss.""enroll15_17"" AS Enrollment_15_17, (ss.""enroll12""-ss.""enroll15_17"") AS Difference FROM satscores ss INNER JOIN schools s ON ss.cds=s.CDSCode WHERE s.""FundingType""='Locally Funded' ), AverageDifference AS ( SELECT AVG(Difference) AS AvgDifference FROM EnrollmentDifferences ) SELECT ed.""School Name"", ed.K12_enrollment, ed.Enrollment_15_17 FROM EnrollmentDifferences ed CROSS JOIN AverageDifference ad WHERE ed.Difference>ad.AvgDifference;","0.1875"
"california_schools","simple","When did the first-through-twelfth-grade school with the largest enrollment open?","SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1","SELECT T2.OpenDate FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T2.SchoolType IN ('Elementary', 'Middle', 'High') ORDER BY T1.enroll12 DESC LIMIT 1;","0.3888888888888889"
"california_schools","simple","Which cities have the top 5 lowest enrollment number for students in grades 1 through 12?","SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 1","SELECT s.City, SUM(sa.enroll12) AS total_enrollment FROM satscores AS sa JOIN schools AS s ON sa.cds=s.CDSCode WHERE sa.enroll12 IS NOT NULL GROUP BY s.City ORDER BY total_enrollment ASC LIMIT 5;","0.2222222222222222"
"california_schools","moderate","What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12?","SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2","SELECT T2.School, T1.enroll12, T2.NSLP_Provision_Status FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds=T2.CDSCode WHERE T2.Grade IN ('1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12') ORDER BY T1.enroll12 DESC LIMIT 2 OFFSET 9;","0.18518518518518517"
"california_schools","moderate","What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66?","SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5","SELECT s.""School Name"", f.""Free or Reduced Price Meal Rate"" FROM frpm AS f JOIN schools AS s ON f.""CDSCode""=s.""CDSCode"" WHERE s.""Ownership Code""='66' AND f.""Academic Year""='2023'--Assuming the latest academic year is 2023 ORDER BY f.""Free or Reduced Price Meal Count"" DESC LIMIT 5;","0.20689655172413793"
"california_schools","moderate","If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school.","SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL","SELECT s.""School Name"", sch.""Website"" FROM frpm AS f JOIN schools AS sch ON f.""CDSCode""=sch.""CDSCode"" WHERE f.""Free Meal Count"" BETWEEN 1900 AND 2000 AND f.""Age Group""='5-17';","0.6"
"california_schools","moderate","What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson?","SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'","SELECT ""NSLP Provision Status"" FROM ""frpm"" WHERE ""School Name""='Kacey Gibson' AND ""CDSCode"" IN ( SELECT ""CDSCode"" FROM ""schools"" WHERE ""School""='Kacey Gibson' ) AND ""Educational Option Type""='Free' AND ""Age"" BETWEEN 5 AND 17;","0.3333333333333333"
"california_schools","moderate","What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12?","SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1","SELECT s.AdmEmail1 FROM schools s JOIN satscores sa ON s.CDSCode=sa.cds WHERE s.Charter=1 AND sa.enroll12 IS NOT NULL ORDER BY sa.enroll12 ASC LIMIT 1;","0.3"
"california_schools","challenging","Under whose administration does the school with the highest number of test takers whose total SAT Scores are greater or equal to 1500 belong to? Indicate his or her full name.","SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1","SELECT CONCAT(T2.AdmFName1, ' ', T2.AdmLName1) AS FullName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T1.NumTstTakr=( SELECT MAX(NumTstTakr) FROM satscores WHERE NumGE1500>=1500 ) AND T1.NumGE1500>=1500 LIMIT 1;","0.5263157894736842"
"california_schools","moderate","What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State.","SELECT T2.Zip, T2.Street, T2.City, T2.State FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1","SELECT s.Street, s.City, s.Zip, s.State FROM schools AS s JOIN satscores AS ss ON s.CDSCode=ss.cds ORDER BY ss.AvgScrRead+ss.AvgScrMath+ss.AvgScrWrite ASC LIMIT 1;","0.5263157894736842"
"california_schools","simple","What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers?","SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'","SELECT T3.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T2.County='Los Angeles' AND T1.NumTstTakr BETWEEN 2000 AND 3000;","0.9285714285714286"
"california_schools","simple","What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980?","SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = 1980 AND T2.County = 'Fresno'","SELECT AVG(T1.NumTstTakr) AS AverageTestTakers FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T2.County='Fresno' AND T2.OpenDate BETWEEN '1980-01-01' AND '1980-12-31';","0.6470588235294118"
"california_schools","moderate","What is the telephone number for the school with the lowest average score in reading in Fresno Unified?","SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.DOC = 54 AND T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1","SELECT s.Phone FROM schools s JOIN satscores ss ON s.CDSCode=ss.cds WHERE s.County='Fresno' ORDER BY ss.AvgScrRead ASC LIMIT 1;","0.5"
"california_schools","simple","Which exclusively virtual schools have the top 5 highest average reading scores?","SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ORDER BY T1.AvgScrRead DESC LIMIT 5","SELECT S.""School Name"", AVG(SC.""AvgScrRead"") AS AvgReadingScore FROM ""frpm"" AS F JOIN ""satscores"" AS SC ON F.""CDSCode""=SC.""cds"" JOIN ""schools"" AS S ON F.""CDSCode""=S.""CDSCode"" WHERE S.""Virtual""='Y' GROUP BY S.""School Name"" ORDER BY AvgReadingScore DESC LIMIT 5;","0.5555555555555556"
"california_schools","simple","What is the type of education offered in the school who scored the highest average in Math?","SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1","SELECT T2.Educational_Option_Type FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds=T2.CDSCode WHERE T1.AvgScrMath=(SELECT MAX(AvgScrMath) FROM satscores) LIMIT 1;","0.5833333333333334"
"california_schools","moderate","What is the average math score of the school with the lowest average score for all subjects, and in which county is it located?","SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1","SELECT AVG(T1.AvgScrMath) AS AverageMathScore, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode GROUP BY T2.County, T2.School ORDER BY AVG(T1.AvgScrRead+T1.AvgScrMath+T1.AvgScrWrite) ASC LIMIT 1;","0.8571428571428571"
"california_schools","simple","What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated.","SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1","SELECT AVG(T1.AvgScrWrite) AS AverageWritingScore, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T1.NumTstTakr>0 AND T1.NumGE1500>0 GROUP BY T2.City ORDER BY COUNT(T1.NumTstTakr) DESC LIMIT 1;","0.7857142857142857"
"california_schools","moderate","What is the average reading score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores.","SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'","SELECT s.""School Name"", AVG(ss.""AvgScrRead"") AS ""Average Reading Score"", AVG(ss.""AvgScrWrite"") AS ""Average Writing Score"" FROM ""satscores"" AS ss INNER JOIN ""schools"" AS s ON ss.cds=s.CDSCode WHERE s.""AdmFName1""='Ricci' AND s.""AdmLName1""='Ulrich' GROUP BY s.""School Name"";","0.5"
"california_schools","simple","Which state special schools have the highest number of enrollees from grades 1 through 12?","SELECT T2.State FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.DOC = 31 ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1","SELECT S.State, S.School, SUM(SA.enroll12) AS Total_Enrollees FROM schools AS S JOIN satscores AS SA ON S.CDSCode=SA.cds WHERE S.SchoolType='Special School' AND SA.enroll12 IS NOT NULL GROUP BY S.State, S.School ORDER BY Total_Enrollees DESC;","0.18181818181818182"
"california_schools","moderate","What is the monthly average number of schools that opened in Alameda County under the jurisdiction of the Elementary School District in 1980?","SELECT CAST(COUNT(School) AS REAL) / 12 FROM schools WHERE DOC = 52 AND County = 'Alameda' AND strftime('%Y', OpenDate) = '1980'","SELECT AVG(monthly_opened) AS monthly_average_schools FROM ( SELECT COUNT(*) AS monthly_opened, EXTRACT(MONTH FROM OpenDate) AS month FROM schools WHERE County='Alameda' AND District LIKE '%Elementary School District%' AND EXTRACT(YEAR FROM OpenDate)=1980 GROUP BY month ) AS monthly_counts;","0.3157894736842105"
"california_schools","moderate","What is the ratio of merged Unified School District schools in Orange County to merged Elementary School District schools?","SELECT CAST(SUM(CASE WHEN DOC = 54 THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN DOC = 52 THEN 1 ELSE 0 END) * 100 FROM schools WHERE StatusType = 'Merged' AND County = 'Orange'","SELECT (SELECT COUNT(*) FROM schools WHERE County='Orange' AND DistrictType='Unified School District' AND StatusType='Merged') AS UnifiedMerged, (SELECT COUNT(*) FROM schools WHERE County='Orange' AND DistrictType='Elementary School District' AND StatusType='Merged') AS ElementaryMerged, (SELECT COUNT(*) FROM schools WHERE County='Orange' AND DistrictType='Unified School District' AND StatusType='Merged')*1.0/(SELECT COUNT(*) FROM schools WHERE County='Orange' AND DistrictType='Elementary School District' AND StatusType='Merged') AS Ratio","0.3684210526315789"
"california_schools","moderate","Which different county has the most number of closed schools?
Please provide the name of each school as well as the closure date.","SELECT DISTINCT County, School, ClosedDate FROM schools WHERE County = ( SELECT County FROM schools WHERE StatusType = 'Closed' GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1 ) AND StatusType = 'Closed' AND school IS NOT NULL","SELECT s.""School Name"", s.""ClosedDate"", s.""County Name"" FROM schools AS s WHERE s.""StatusType""='Closed' AND s.""ClosedDate"" IS NOT NULL AND s.""County"" IS NOT NULL ORDER BY s.""County Name"" GROUP BY s.""County Name"", s.""School Name"", s.""ClosedDate"" HAVING COUNT(s.""School Name"")=( SELECT MAX(closed_count) FROM ( SELECT COUNT(*) AS closed_count FROM schools WHERE ""StatusType""='Closed' GROUP BY ""County"" ) AS county_counts );","0.5"
"california_schools","simple","What is the postal street address for the school with the 6th highest Math average? Indicate the school's name.","SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 5, 1","SELECT S.""School Name"", S.""Street"", S.""City"", S.""Zip"", S.""State"" FROM ( SELECT T1.""sname"", T1.""AvgScrMath"" FROM satscores AS T1 ORDER BY T1.""AvgScrMath"" DESC LIMIT 6 ) AS MathScores JOIN schools AS S ON MathScores.""sname""=S.""School"" ORDER BY MathScores.""AvgScrMath"" ASC LIMIT 1;","0.3181818181818182"
"california_schools","simple","In which mailing street address can you find the school that has the lowest average score in reading? Also give the school's name.","SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1","SELECT s.MailStreet, s.School FROM schools s JOIN satscores ss ON s.CDSCode=ss.cds WHERE ss.AvgScrRead=(SELECT MIN(AvgScrRead) FROM satscores)","0.5384615384615384"
"california_schools","simple","What is the total number of schools whose total SAT scores are greater or equal to 1500 whose mailing city is Lafayette?","SELECT COUNT(T1.cds) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Lafayette'","SELECT COUNT(*) AS TotalSchools FROM schools AS S JOIN satscores AS SS ON S.CDSCode=SS.cds WHERE SS.NumGE1500>=1500 AND S.MailCity='Lafayette';","0.46153846153846156"
"california_schools","simple","How many test takers are there at the school/s whose mailing city address is in Fresno?","SELECT T1.NumTstTakr FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Fresno'","SELECT SUM(T1.NumTstTakr) AS TotalTestTakers FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T2.MailCity='Fresno';","0.9"
"california_schools","simple","Please specify all of the schools and their related mailing zip codes that are under Avetik Atoian's administration.","SELECT School, MailZip FROM schools WHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'","SELECT s.""School Name"", s.""MailZip"" FROM ""frpm"" AS f JOIN ""schools"" AS s ON f.""CDSCode""=s.""CDSCode"" WHERE f.""AdmFName1""='Avetik' AND f.""AdmLName1""='Atoian';","0.5833333333333334"
"california_schools","moderate","Of the schools with a mailing state address in California, what is the ratio of the schools located in the county of Colusa against the school located in the county of Humboldt?","SELECT CAST(SUM(CASE WHEN County = 'Colusa' THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN County = 'Humboldt' THEN 1 ELSE 0 END) FROM schools WHERE MailState = 'CA'","SELECT (SELECT COUNT(*) FROM schools WHERE MailState='CA' AND County='Colusa')*1.0/(SELECT COUNT(*) FROM schools WHERE MailState='CA' AND County='Humboldt') AS Ratio","0.8888888888888888"
"california_schools","simple","Of all the schools with a mailing state address in California, how many are active in San Joaquin?","SELECT COUNT(CDSCode) FROM schools WHERE City = 'San Joaquin' AND State = 'CA' AND StatusType = 'Active'","SELECT COUNT(*) FROM schools WHERE MailState='CA' AND StatusType='Active' AND County='San Joaquin';","0.5454545454545454"
"california_schools","simple","What is the phone number and extension number for the school that had the 333rd highest average writing score?","SELECT T2.Phone, T2.Ext FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrWrite DESC LIMIT 332, 1","SELECT S.Phone, S.Ext FROM schools AS S JOIN ( SELECT cds, AVG(AvgScrWrite) AS AvgWritingScore FROM satscores GROUP BY cds ORDER BY AvgWritingScore DESC LIMIT 1 OFFSET 332 ) AS AvgScores ON S.CDSCode=AvgScores.cds;","0.6666666666666666"
"california_schools","simple","What is the phone number and extension number for the school with the zip code 95203-3704? Indicate the school's name.","SELECT Phone, Ext, School FROM schools WHERE Zip = '95203-3704'","SELECT School, Phone, Ext FROM schools WHERE Zip='95203-3704';","1.0"
"california_schools","simple","What is the website for the schools under the administrations of Mike Larson and Dante Alvarez?","SELECT Website FROM schools WHERE (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez')","SELECT s.Website FROM schools AS s WHERE s.AdmFName1='Mike' AND s.AdmLName1='Larson' OR s.AdmFName1='Dante' AND s.AdmLName1='Alvarez';","0.8888888888888888"
"california_schools","simple","What are the websites for all the partially virtual chartered schools located in San Joaquin?","SELECT Website FROM schools WHERE County = 'San Joaquin' AND Virtual = 'P' AND Charter = 1","SELECT s.Website FROM schools s WHERE s.County='San Joaquin' AND s.Virtual='Partially' AND s.Charter=1;","0.7272727272727273"
"california_schools","simple","How many chartered schools located in the city of Hickman are owned by the Elementary School District?","SELECT COUNT(School) FROM schools WHERE DOC = 52 AND Charter = 1 AND City = 'Hickman'","SELECT COUNT(*) FROM schools WHERE City='Hickman' AND Charter=1 AND District='Elementary School District';","0.6"
"california_schools","challenging","What is the total number of non-chartered schools in the county of Los Angeles with a percent (%) of eligible free meals for grades 1 through 12 that is less than 0.18%?","SELECT COUNT(T2.School) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.Charter = 0 AND CAST(T1.`Free Meal Count (K-12)` AS REAL) * 100 / T1.`Enrollment (K-12)` < 0.18","SELECT COUNT(*) AS TotalNonCharteredSchools FROM frpm AS f JOIN schools AS s ON f.CDSCode=s.CDSCode WHERE s.County='Los Angeles' AND s.Charter=0 AND f.""Percent Eligible Free Meals""<0.18;","0.4166666666666667"
"california_schools","simple","In chartered schools with charter number 00D2, what are the names of all the administrators? Include the name of the school and the city to which it belongs","SELECT AdmFName1, AdmLName1, School, City FROM schools WHERE Charter = 1 AND CharterNum = '00D2'","SELECT s.School AS SchoolName, s.City, s.AdmFName1 || ' ' || s.AdmLName1 AS AdministratorName FROM schools AS s WHERE s.CharterNum='00D2' AND (s.AdmFName1 IS NOT NULL AND s.AdmLName1 IS NOT NULL) UNION ALL SELECT s.School AS SchoolName, s.City, s.AdmFName2 || ' ' || s.AdmLName2 AS AdministratorName FROM schools AS s WHERE s.CharterNum='00D2' AND (s.AdmFName2 IS NOT NULL AND s.AdmLName2 IS NOT NULL) UNION ALL SELECT s.School AS SchoolName, s.City, s.AdmFName3 || ' ' || s.AdmLName3 AS AdministratorName FROM schools AS s WHERE s.CharterNum='00D2' AND (s.AdmFName3 IS NOT NULL AND s.AdmLName3 IS NOT NULL);","0.4375"
"california_schools","simple","What is the total number of schools with a mailing city in Handford belonging to the charter number 00D4?","SELECT COUNT(*) FROM schools WHERE CharterNum = '00D4' AND City = 'Hanford'","SELECT COUNT(*) AS TotalSchools FROM schools WHERE MailCity='Handford' AND CharterNum='00D4';","0.375"
"california_schools","moderate","What is the ratio in percentage of Santa Clara County schools that are locally funded compared to all other types of charter school funding?","SELECT CAST(SUM(CASE WHEN FundingType = 'Locally funded' THEN 1 ELSE 0 END) AS REAL) * 100 / SUM(CASE WHEN FundingType != 'Locally funded' THEN 1 ELSE 0 END) FROM schools WHERE County = 'Santa Clara' AND Charter = 1","SELECT (COUNT(CASE WHEN FundingType='Locally Funded' THEN 1 END)*100.0/COUNT(*)) AS Locally_Funded_Percentage FROM schools WHERE County='Santa Clara' AND Charter=1;","0.9166666666666666"
"california_schools","simple","Between 1/1/2000 to 12/31/2005, how many directly funded schools opened in the county of Stanislaus?","SELECT COUNT(School) FROM schools WHERE strftime('%Y', OpenDate) BETWEEN '2000-01-01' AND '2005-12-31' AND County = 'Stanislaus' AND FundingType = 'Directly funded'","SELECT COUNT(*) AS NumberOfSchoolsOpened FROM schools WHERE County='Stanislaus' AND OpenDate BETWEEN '2000-01-01' AND '2005-12-31' AND FundingType='Directly Funded';","0.75"
"california_schools","simple","What is the total amount of Community College District closure in 1989 in the city of San Francisco?","SELECT COUNT(School) FROM schools WHERE strftime('%Y', ClosedDate) = '1989' AND City = 'San Francisco' AND DOCType = 'Community College District'","SELECT COUNT(*) AS TotalClosures FROM schools WHERE ClosedDate BETWEEN '1989-01-01' AND '1989-12-31' AND City='San Francisco';","0.35294117647058826"
"california_schools","moderate","Which county reported the most number of school closure in the 1980s with school wonership code belonging to Youth Authority Facilities (CEA)?","SELECT County FROM schools WHERE strftime('%Y', ClosedDate) BETWEEN '1980' AND '1989' AND StatusType = 'Closed' AND SOC = 11 GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1","SELECT County, COUNT(*) AS ClosureCount FROM schools WHERE ClosedDate BETWEEN '1980-01-01' AND '1989-12-31' AND EdOpsCode='CEA' GROUP BY County ORDER BY ClosureCount DESC LIMIT 1;","0.35"
"california_schools","simple","Please provide the National Center for Educational Statistics school district identification number for all schools with a School Ownership Code that are part of the State Special Schools.","SELECT NCESDist FROM schools WHERE SOC = 31","SELECT s.NCESDist FROM schools AS s WHERE s.SOC IS NOT NULL AND s.FundingType='State Special Schools';","0.375"
"california_schools","simple","How many active and closed District Community Day Schools are there in the county of Alpine?","SELECT COUNT(School) FROM schools WHERE StatusType = 'Closed' OR StatusType = 'Active' AND County = 'Alpine'","SELECT SUM(CASE WHEN StatusType='Active' THEN 1 ELSE 0 END) AS ActiveSchools, SUM(CASE WHEN StatusType='Closed' THEN 1 ELSE 0 END) AS ClosedSchools FROM schools WHERE County='Alpine' AND SchoolType='District Community Day School';","0.4666666666666667"
"california_schools","simple","What is the district code for the School that does not offer a magnet program in the city of Fresno?","SELECT T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Fresno' AND T2.Magnet = 0","SELECT DISTINCT s.District FROM schools s WHERE s.City='Fresno' AND s.Magnet=0;","0.5"
"california_schools","moderate","How many students from the ages of 5 to 17 are enrolled at the State Special School school in Fremont for the 2014-2015 academic year?","SELECT T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.EdOpsCode = 'SSS' AND T1.`Academic Year` BETWEEN 2014 AND 2015","SELECT SUM(T1.enroll12) AS TotalStudents FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T2.School='State Special School' AND T2.City='Fremont' AND T1.Academic Year='2014-2015' AND T1.enroll12 BETWEEN 5 AND 17;","0.4166666666666667"
"california_schools","simple","What is the free or reduced price meal count for ages 5 to 17 in the Youth Authority School with a mailing street address of PO Box 1040?","SELECT T1.`FRPM Count (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.MailStreet = 'PO Box 1040' AND T2.SOCType = 'Youth Authority Facilities'","SELECT SUM(f.FreeReducedPriceMealCount) AS FreeReducedPriceMealCount FROM frpm AS f JOIN schools AS s ON f.CDSCode=s.CDSCode WHERE s.MailStreet='PO Box 1040' AND f.Age BETWEEN 5 AND 17 AND s.SchoolType='Youth Authority School';","0.5"
"california_schools","moderate","What is the lowest grade for the District Special Education Consortia School with National Center for Educational Statistics school district identification number of 613360?","SELECT MIN(T1.`Low Grade`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.NCESDist = 613360 AND T2.EdOpsCode = 'SPECON'","SELECT MIN(T1.AvgScrRead) AS LowestGrade FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T2.NCESDist='613360' AND T2.SchoolType='District Special Education Consortia School';","0.2857142857142857"
"california_schools","simple","What is the educational level name for the schools with Breakfast Provision 2 in county code 37? Indicate the name of the school.","SELECT T2.EILName, T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Breakfast Provision 2' AND T1.`County Code` = 37","SELECT s.School, f.""Educational Option Type"" FROM frpm AS f JOIN schools AS s ON f.CDSCode=s.CDSCode WHERE f.""NSLP Provision Status""='2' AND f.""County Code""='37';","0.55"
"california_schools","moderate","What is the city location of the high school level school with Lunch Provision 2 whose lowest grade is 9 and the highest grade is 12 in the county of Merced?","SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Lunch Provision 2' AND T2.County = 'Merced' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12 AND T2.EILCode = 'HS'","SELECT s.City FROM schools s WHERE s.County='Merced' AND s.GSserved='High School' AND s.NSLP Provision Status='2' AND s.GSoffered IN ('9', '10', '11', '12') AND s.GSserved='12';","0.4230769230769231"
"california_schools","moderate","Which schools served a grade span of Kindergarten to 9th grade in the county of Los Angeles and what is its Percent (%) Eligible FRPM (Ages 5-17)?","SELECT T2.School, T1.`FRPM Count (Ages 5-17)` * 100 / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.GSserved = 'K-9'","SELECT s.School, f.""Percent (%) Eligible FRPM (Ages 5-17)"" FROM schools AS s JOIN frpm AS f ON s.CDSCode=f.CDSCode WHERE s.County='Los Angeles' AND s.GSserved='K-9';","0.6190476190476191"
"california_schools","simple","What is the most common type of grade span served in the city of Adelanto?","SELECT GSserved FROM schools WHERE City = 'Adelanto' GROUP BY GSserved ORDER BY COUNT(GSserved) DESC LIMIT 1","SELECT GSserved, COUNT(*) AS count FROM schools WHERE City='Adelanto' GROUP BY GSserved ORDER BY count DESC LIMIT 1;","1.0"
"california_schools","moderate","Between San Diego and Santa Barbara, which county offers the most number of schools that does not offer physical building? Indicate the amount.","SELECT County, COUNT(Virtual) FROM schools WHERE County = 'San Diego' OR County = 'Santa Barbara' AND Virtual = 'F' GROUP BY County ORDER BY COUNT(Virtual) DESC LIMIT 1","SELECT County, COUNT(*) AS SchoolCount FROM schools WHERE City IN ('San Diego', 'Santa Barbara') AND Virtual='Y' GROUP BY County ORDER BY SchoolCount DESC LIMIT 1;","0.6923076923076923"
"california_schools","simple","What is the school type of the school with the highest latitude? Indicate the name of the school as well as the latitude coordinates.","SELECT T1.`School Type`, T1.`School Name`, T2.Latitude FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.Latitude DESC LIMIT 1","SELECT ""School Name"", ""Latitude"", ""School Type"" FROM frpm WHERE ""Latitude""=(SELECT MAX(""Latitude"") FROM schools) LIMIT 1;","0.6363636363636364"
"california_schools","moderate","In which city can you find the school in the state of California with the lowest latitude coordinates and what is its lowest grade? Indicate the school name.","SELECT T2.City, T1.`Low Grade`, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.State = 'CA' ORDER BY T2.Latitude ASC LIMIT 1","SELECT City, School Name, LowestGrade FROM schools WHERE State='California' ORDER BY Latitude ASC LIMIT 1;","0.47058823529411764"
"california_schools","simple","What is the grade span offered in the school with the highest longitude?","SELECT GSoffered FROM schools ORDER BY ABS(longitude) DESC LIMIT 1","SELECT GSoffered FROM schools WHERE Longitude=(SELECT MAX(Longitude) FROM schools);","0.5"
"california_schools","challenging","Of the schools that offers a magnet program serving a grade span of Kindergarten to 8th grade, how many offers Multiple Provision Types? List the number of cities that offers a Kindergarten to 8th grade span and indicate how many schools are there serving such grade span for each city.","SELECT T2.City, COUNT(T2.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.Magnet = 1 AND T2.GSoffered = 'K-8' AND T1.`NSLP Provision Status` = 'Multiple Provision Types' GROUP BY T2.City","WITH MagnetSchools AS ( SELECT s.City, COUNT(s.School) AS SchoolCount, COUNT(DISTINCT s.NSLPProvisionStatus) AS ProvisionTypes FROM schools s WHERE s.Magnet=1 AND s.GSserved='K-8' GROUP BY s.City ), CitiesWithK8 AS ( SELECT City, COUNT(School) AS SchoolCount FROM schools WHERE GSserved='K-8' GROUP BY City ) SELECT c.City, c.SchoolCount, COALESCE(m.ProvisionTypes, 0) AS MultipleProvisionTypes FROM CitiesWithK8 c LEFT JOIN (SELECT City, COUNT(DISTINCT ProvisionTypes) AS ProvisionTypes FROM MagnetSchools GROUP BY City) m ON c.City=m.City;","0.2"
"california_schools","simple","What are the two most common first names among the school administrators? Indicate the district to which they administer.","SELECT DISTINCT T1.AdmFName1, T1.District FROM schools AS T1 INNER JOIN ( SELECT admfname1 FROM schools GROUP BY admfname1 ORDER BY COUNT(admfname1) DESC LIMIT 2 ) AS T2 ON T1.AdmFName1 = T2.admfname1","SELECT AdmFName1, District, COUNT(*) AS NameCount FROM schools WHERE AdmFName1 IS NOT NULL GROUP BY AdmFName1, District ORDER BY NameCount DESC LIMIT 2;","0.625"
"california_schools","moderate","What is the Percent (%) Eligible Free (K-12) in the school administered by an administrator whose first name is Alusine. List the district code of the school.","SELECT T1.`Free Meal Count (K-12)` * 100 / T1.`Enrollment (K-12)`, T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Alusine'","SELECT frpm.""District Code"", (SUM(CASE WHEN frpm.""NSLP Provision Status""='Eligible Free' THEN 1 ELSE 0 END)*100.0/COUNT(*)) AS ""Percent Eligible Free"" FROM frpm JOIN schools ON frpm.""CDSCode""=schools.""CDSCode"" WHERE schools.""AdmFName1""='Alusine' GROUP BY frpm.""District Code"";","0.4090909090909091"
"california_schools","simple","What is the administrator's last name that oversees the school with Charter number 40? Indicate the district, the county where the school is situated, and the name of the school.","SELECT AdmLName1, District, County, School FROM schools WHERE CharterNum = '0040'","SELECT s.AdmLName1, s.District, s.County, s.School FROM schools AS s WHERE s.CharterNum='40';","0.6666666666666666"
"california_schools","challenging","What is the e-mail address of the administrator of the school located in the San Bernardino county, District of San Bernardino City Unified that opened between 1/1/2009 to 12/31/2010 whose school types are public Intermediate/Middle Schools and Unified Scools?","SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'San Bernardino' AND T2.City = 'San Bernardino' AND T2.DOC = 54 AND strftime('%Y', T2.OpenDate) BETWEEN '2009' AND '2010' AND T2.SOC = 62","SELECT AdmEmail1 FROM schools WHERE County='San Bernardino' AND District='San Bernardino City Unified' AND OpenDate BETWEEN '2009-01-01' AND '2010-12-31' AND (SchoolType='Public Intermediate/Middle Schools' OR SchoolType='Unified Schools');","0.32142857142857145"
"california_schools","simple","What is the administrator's email address for the school with the highest number of test takers who received SAT scores of at least 1500?Provide the name of the school.","SELECT T2.AdmEmail1, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1","SELECT T2.AdmEmail1, T2.School Name FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds=T2.CDSCode WHERE T1.NumGE1500>0 ORDER BY T1.NumTstTakr DESC LIMIT 1;","0.7857142857142857"
"thrombosis_prediction","moderate","Are there more in-patient or outpatient who were male? What is the deviation in percentage?","SELECT CAST(SUM(CASE WHEN Admission = '+' THEN 1 ELSE 0 END) AS REAL) * 100 / SUM(CASE WHEN Admission = '-' THEN 1 ELSE 0 END) FROM Patient WHERE SEX = 'M'","WITH MalePatients AS ( SELECT COUNT(*) AS Total, Admission FROM Patient WHERE SEX='Male' GROUP BY Admission ), InPatientCount AS ( SELECT Total AS InPatientTotal FROM MalePatients WHERE Admission='In-Patient' ), OutPatientCount AS ( SELECT Total AS OutPatientTotal FROM MalePatients WHERE Admission='Out-Patient' ) SELECT InPatientTotal, OutPatientTotal, CASE WHEN InPatientTotal>OutPatientTotal THEN 'In-Patient' ELSE 'Out-Patient' END AS MorePatients, ABS((InPatientTotal-OutPatientTotal)*100.0/NULLIF((InPatientTotal+OutPatientTotal), 0)) AS PercentageDeviation FROM InPatientCount, OutPatientCount;","0.25"
"thrombosis_prediction","moderate","What is the percentage of female patient were born after 1930?","SELECT CAST(SUM(CASE WHEN SEX = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) FROM Patient WHERE STRFTIME('%Y', Birthday) > '1930'","SELECT (COUNT(CASE WHEN P.SEX='Female' AND P.Birthday>'1930-01-01' THEN 1 END)*100.0/COUNT(*)) AS FemalePercentage FROM Patient P;","0.5"
"thrombosis_prediction","moderate","For patient born between Year 1930 to 1940, how many percent of them were inpatient?","SELECT CAST(SUM(CASE WHEN Admission = '+' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) FROM Patient WHERE STRFTIME('%Y', Birthday) BETWEEN '1930' AND '1940'","SELECT (COUNT(CASE WHEN P.Admission='Inpatient' THEN 1 END)*100.0/COUNT(*)) AS inpatient_percentage FROM Patient P WHERE strftime('%Y', P.Birthday) BETWEEN '1930' AND '1940';","0.7692307692307693"
"thrombosis_prediction","moderate","What is the ratio of outpatient to inpatient followed up treatment among all the 'SLE' diagnosed patient?","SELECT SUM(CASE WHEN Admission = '+' THEN 1 ELSE 0 END) / SUM(CASE WHEN Admission = '-' THEN 1 ELSE 0 END) FROM Patient WHERE Diagnosis = 'SLE'","SELECT SUM(CASE WHEN Admission='Outpatient' THEN 1 ELSE 0 END) AS Outpatient_Count, SUM(CASE WHEN Admission='Inpatient' THEN 1 ELSE 0 END) AS Inpatient_Count, CASE WHEN SUM(CASE WHEN Admission='Inpatient' THEN 1 ELSE 0 END)=0 THEN NULL ELSE SUM(CASE WHEN Admission='Outpatient' THEN 1 ELSE 0 END)*1.0/SUM(CASE WHEN Admission='Inpatient' THEN 1 ELSE 0 END) END AS Ratio FROM Patient WHERE Diagnosis='SLE';","0.5454545454545454"
"thrombosis_prediction","simple","What is the disease patient '30609' diagnosed with. List all the date of laboratory tests done for this patient.","SELECT T1.Diagnosis, T2.Date FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.ID = 30609","SELECT E.Diagnosis, L.Date FROM Patient P JOIN Examination E ON P.ID=E.ID JOIN Laboratory L ON P.ID=L.ID WHERE P.ID=30609;","0.45454545454545453"
"thrombosis_prediction","simple","State the sex and birthday of patient ID '163109'. When was the examination taken and what symptom does the patient had.","SELECT T1.SEX, T1.Birthday, T2.`Examination Date`, T2.Symptoms FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.ID = 163109","SELECT P.SEX, P.Birthday, E.""Examination Date"", E.Symptoms FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE P.ID='163109';","0.6363636363636364"
"thrombosis_prediction","simple","List the patient ID, sex and birthday of patient with LDH beyond normal range.","SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.LDH > 500","SELECT P.ID, P.SEX, P.Birthday FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.LDH>250;--Assuming 250 is the threshold for LDH beyond normal range","0.3157894736842105"
"thrombosis_prediction","moderate","State the ID and age of patient with positive degree of coagulation.","SELECT DISTINCT T1.ID, STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.RVVT = '+'","SELECT P.ID, strftime('%Y', 'now')-strftime('%Y', P.Birthday) AS Age FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.KCT='Positive' OR E.RVVT='Positive' OR E.LAC='Positive';","0.4117647058823529"
"thrombosis_prediction","simple","For patients with severe degree of thrombosis, list their ID, sex and dieseas the patient is diagnosed with.","SELECT DISTINCT T1.ID, T1.SEX, T1.Diagnosis FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.Thrombosis = 2","SELECT P.ID, P.SEX, E.Diagnosis FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.Thrombosis=3;","0.5"
"thrombosis_prediction","moderate","List all patients who were born in 1937 whose total cholesterol was beyond the normal range.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T1.Birthday) = '1937' AND T2.`T-CHO` >= 250","SELECT P.ID, P.Birthday, L.T-CHO FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE strftime('%Y', P.Birthday)='1937' AND L.T-CHO>200;","0.6"
"thrombosis_prediction","simple","For patient with albumin level lower than 3.5, list their ID, sex and diagnosis.","SELECT DISTINCT T1.ID, T1.SEX, T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.ALB < 3.5","SELECT P.ID, P.SEX, P.Diagnosis FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.ALB<3.5;","0.6666666666666666"
"thrombosis_prediction","moderate","What is the percentage of female patient had total protein not within the normal range?","SELECT CAST(SUM(CASE WHEN T1.SEX = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TP <= 6.0 OR T2.TP >= 8.5","SELECT (COUNT(CASE WHEN L.TP NOT BETWEEN 6.0 AND 8.0 THEN 1 END)*100.0/COUNT(*)) AS percentage_female_patients_with_abnormal_tp FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE P.SEX='Female';","0.5555555555555556"
"thrombosis_prediction","challenging","For in-patient age 50 and above, what is their average anti-cardiolipin antibody (IgG) concentration?","SELECT AVG(T2.`aCL IgG`) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) > 50 AND T1.Admission = '+'","SELECT AVG(T3.""aCL IgG"") AS average_aCL_IgG FROM Patient AS T1 INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE (julianday('now')-julianday(T1.Birthday))/365.25>=50;","0.42105263157894735"
"thrombosis_prediction","moderate","How many female patients who came at the hospital in 1997 was immediately followed at the outpatient clinic?","SELECT COUNT(*) FROM Patient WHERE STRFTIME('%Y', Description) = '1997' AND SEX = 'F' AND Admission = '-'","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE P.SEX='Female' AND strftime('%Y', P.First_Date)='1997' AND E.""Examination Date""=P.""First Date"";","0.3333333333333333"
"thrombosis_prediction","simple","What was the age of the youngest patient when they initially arrived at the hospital?","SELECT STRFTIME('%Y', `First Date`) - STRFTIME('%Y', Birthday) FROM Patient ORDER BY `First Date` DESC LIMIT 1","SELECT MIN(JULIANDAY(""First Date"")-JULIANDAY(Birthday))/365.25 AS Youngest_Age FROM Patient WHERE ""First Date"" IS NOT NULL;","0.2727272727272727"
"thrombosis_prediction","moderate","How many of the patients with the most serious thrombosis cases examined in 1997 are women?","SELECT CAST(SUM(CASE WHEN T1.SEX = 'F' THEN 1 ELSE 0 END) AS REAL) / COUNT(*) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T2.`Examination Date`) = '1997' AND T2.Thrombosis = 1","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Female' AND T2.Examination_Date BETWEEN '1997-01-01' AND '1997-12-31' AND T2.Thrombosis=(SELECT MAX(Thrombosis) FROM Examination WHERE Examination_Date BETWEEN '1997-01-01' AND '1997-12-31');","0.4444444444444444"
"thrombosis_prediction","moderate","What is the age gap between the youngest and oldest patient with a normal triglyceride recorded?","SELECT STRFTIME('%Y', MAX(T1.Birthday)) - STRFTIME('%Y', MIN(T1.Birthday)) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TG >= 200","SELECT MAX(JULIANDAY(Birthday))-MIN(JULIANDAY(Birthday)) AS age_gap FROM Patient WHERE ID IN ( SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.TG<150--Assuming normal triglyceride level is less than 150 mg/dL );","0.3333333333333333"
"thrombosis_prediction","simple","What are the symptoms observed by the youngest patient to ever did a medical examination? Identify their diagnosis.","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.Symptoms IS NOT NULL ORDER BY T1.Birthday DESC LIMIT 1","SELECT T3.Symptoms, T3.Diagnosis FROM Examination AS T3 INNER JOIN Patient AS T1 ON T3.ID=T1.ID WHERE T1.Birthday=(SELECT MAX(Birthday) FROM Patient)","0.6363636363636364"
"thrombosis_prediction","moderate","For the year that concluded on December 31, 1998, how many male patients on average were tested in the lab each month?","SELECT CAST(COUNT(T1.ID) AS REAL) / 12 FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T2.Date) = '1998' AND T1.SEX = 'M'","SELECT AVG(monthly_count) AS average_male_patients FROM ( SELECT strftime('%Y-%m', ""Examination Date"") AS month, COUNT(DISTINCT Patient.ID) AS monthly_count FROM Examination INNER JOIN Patient ON Examination.ID=Patient.ID WHERE Patient.SEX='Male' AND ""Examination Date"">='1998-01-01' AND ""Examination Date""<='1998-12-31' GROUP BY month ) AS monthly_counts;","0.42105263157894735"
"thrombosis_prediction","challenging","The oldest Aortitis patient's medical laboratory work was completed on what date, and what age was the patient when they initially arrived at the hospital?","SELECT STRFTIME('%Y', T2.`First Date`) - STRFTIME('%Y', T2.Birthday) , T1.Date FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T2.Birthday IS NOT NULL ORDER BY T2.Birthday DESC LIMIT 1","SELECT MIN(E.""Examination Date"") AS Oldest_Examination_Date, (strftime('%Y', P.""First Date"")-strftime('%Y', P.Birthday)) AS Patient_Age FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE P.Diagnosis='Aortitis' GROUP BY P.ID ORDER BY Oldest_Examination_Date LIMIT 1;","0.3888888888888889"
"thrombosis_prediction","challenging","What is the ratio of male to female patients among all those with abnormal uric acid counts?","SELECT CAST(SUM(CASE WHEN T2.UA <= 8.0 AND T1.SEX = 'M' THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN T2.UA <= 6.5 AND T1.SEX = 'F' THEN 1 ELSE 0 END) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID","SELECT SUM(CASE WHEN P.SEX='Male' THEN 1 ELSE 0 END) AS Male_Count, SUM(CASE WHEN P.SEX='Female' THEN 1 ELSE 0 END) AS Female_Count, CASE WHEN SUM(CASE WHEN P.SEX='Female' THEN 1 ELSE 0 END)=0 THEN NULL ELSE SUM(CASE WHEN P.SEX='Male' THEN 1 ELSE 0 END)*1.0/SUM(CASE WHEN P.SEX='Female' THEN 1 ELSE 0 END) END AS Male_to_Female_Ratio FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.UA>7;--Assuming abnormal uric acid counts are greater than 7","0.23333333333333334"
"thrombosis_prediction","moderate","How many patients hadn't undergone a medical examination until at least a year following their initial hospital visit?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.Admission = '+' AND STRFTIME('%Y', T1.`First Date`) - STRFTIME('%Y', T2.`Examination Date`) >= 1","SELECT COUNT(P.ID) FROM Patient AS P WHERE P.ID NOT IN ( SELECT E.ID FROM Examination AS E WHERE E.Examination_Date>=DATE(P.First_Date, '+1 year') ) AND P.First_Date IS NOT NULL;","0.26666666666666666"
"thrombosis_prediction","challenging","How many underage patients were examined during the course of the three-year period from 1990 to 1993?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T2.`Examination Date`) BETWEEN '1990' AND '1993' AND STRFTIME('%Y', T2.`Examination Date`) - STRFTIME('%Y', T1.Birthday) < '18'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID=T2.ID WHERE T1.Birthday>DATE('1990-01-01') AND T1.Birthday<DATE('1993-12-31') AND (strftime('%Y', 'now')-strftime('%Y', T1.Birthday))<18;","0.7333333333333333"
"thrombosis_prediction","simple","How many male patients have elevated total bilirubin count?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`T-BIL` >= 2.0 AND T1.SEX = 'M'","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE P.SEX='Male' AND L.""T-BIL"">1.2;","0.4666666666666667"
"thrombosis_prediction","challenging","What is the most common illness that doctors identified among the patients whose lab work was done between 1/1/1985, and 12/31/1995?","SELECT T2.Diagnosis FROM Examination AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.`Examination Date` BETWEEN '1985-01-01' AND '1995-12-31' GROUP BY T2.Diagnosis ORDER BY COUNT(T2.Diagnosis) DESC LIMIT 1","SELECT Diagnosis, COUNT(*) AS DiagnosisCount FROM Examination WHERE ""Examination Date"" BETWEEN '1985-01-01' AND '1995-12-31' GROUP BY Diagnosis ORDER BY DiagnosisCount DESC LIMIT 1;","0.6428571428571429"
"thrombosis_prediction","moderate","What is the average age of patients examined in the laboratory for the October of the year 1991?","SELECT AVG('1999' - STRFTIME('%Y', T2.Birthday)) FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T1.Date BETWEEN '1991-10-01' AND '1991-10-30'","SELECT AVG(strftime('%Y', 'now')-strftime('%Y', Birthday)) AS Average_Age FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.""Examination Date"" BETWEEN '1991-10-01' AND '1991-10-31';","0.42105263157894735"
"thrombosis_prediction","moderate","How old was the patient who had the highest hemoglobin count at the time of the examination, and what is the doctor's diagnosis?","SELECT STRFTIME('%Y', T2.Date) - STRFTIME('%Y', T1.Birthday), T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID ORDER BY T2.HGB DESC LIMIT 1","SELECT (strftime('%Y', 'now')-strftime('%Y', P.Birthday)) AS Age, E.Diagnosis FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE L.HGB=(SELECT MAX(HGB) FROM Laboratory)","0.4444444444444444"
"thrombosis_prediction","simple","What was the anti-nucleus antibody concentration level for the patient id 3605340 on 1996/12/2?","SELECT ANA FROM Examination WHERE ID = 3605340 AND `Examination Date` = '1996-12-02'","SELECT ""aCL IgG"" FROM Examination WHERE ID=3605340 AND ""Examination Date""='1996-12-02';","0.6666666666666666"
"thrombosis_prediction","simple","Was the total cholesterol status for the patient id 2927464 on 1995-9-4 at the normal level?","SELECT CASE WHEN `T-CHO` < 250 THEN 'Normal' ELSE 'Abnormal' END FROM Laboratory WHERE ID = 2927464 AND Date = '1995-9-4'","SELECT CASE WHEN T.T-CHO BETWEEN 200 AND 239 THEN 'Normal' ELSE 'Abnormal' END AS Cholesterol_Status FROM Laboratory AS T WHERE T.ID=2927464 AND T.Date='1995-09-04';","0.5"
"thrombosis_prediction","simple","What was the gender of the first AORTITIS diagnosed patient","SELECT SEX FROM Patient WHERE Diagnosis = 'AORTITIS' ORDER BY `First Date` ASC LIMIT 1","SELECT P.SEX FROM Patient P INNER JOIN Examination E ON P.ID=E.ID WHERE E.Diagnosis='AORTITIS' ORDER BY P.First Date LIMIT 1;","0.5454545454545454"
"thrombosis_prediction","moderate","For the patient who was diagnosed with SLE on 1994/2/19, what was his/her anti-Cardiolipin antibody concentration status on 1993/11/12?","SELECT `aCL IgA`, `aCL IgG`, `aCL IgM` FROM Examination WHERE ID IN ( SELECT ID FROM Patient WHERE Diagnosis = 'SLE' AND Description = '1994-02-19' ) AND `Examination Date` = '1993-11-12'","SELECT T3.""aCL IgG"", T3.""aCL IgM"", T3.""aCL IgA"" FROM Patient AS T1 INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T1.Diagnosis='SLE' AND T1.""First Date""='1994-02-19' AND T3.""Examination Date""='1993-11-12';","0.7894736842105263"
"thrombosis_prediction","moderate","Was the patient a man or a women whose ALT glutamic pylvic transaminase status got 9 on 1992-6-12?","SELECT T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GPT = 9.0 AND T2.Date = '1992-6-12'","SELECT T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.GPT=9 AND T2.Date='1992-06-12';","0.7692307692307693"
"thrombosis_prediction","moderate","For the patient who got the laboratory test of uric acid level as 8.4 on 1991-10-21, how old was he/she at that time?","SELECT STRFTIME('%Y', T2.Date) - STRFTIME('%Y', T1.Birthday) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.UA = 8.4 AND T2.Date = '1991-10-21'","SELECT (strftime('%Y', '1991-10-21')-strftime('%Y', P.Birthday))-(strftime('%m-%d', '1991-10-21')<strftime('%m-%d', P.Birthday)) AS Age FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.Date='1991-10-21' AND L.UA=8.4;","0.631578947368421"
"thrombosis_prediction","moderate","For the patient who first came to the hospital on 1991/6/13 who was diagnosed with SJS, what is the total number of his/her Laboratory tests in 1995?","SELECT COUNT(*) FROM Laboratory WHERE ID = ( SELECT ID FROM Patient WHERE `First Date` = '1991-06-13' AND Diagnosis = 'SJS' ) AND STRFTIME('%Y', Date) = '1995'","SELECT COUNT(L.ID) AS Total_Laboratory_Tests FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE P.First_Date='1991-06-13' AND P.Diagnosis='SJS' AND L.Date BETWEEN '1995-01-01' AND '1995-12-31';","0.47368421052631576"
"thrombosis_prediction","challenging","For the patient who was diagnosed SLE on 1997/1/27, what was his/her original diagnose when he/she came to the hospital for the first time?","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.ID = ( SELECT ID FROM Examination WHERE `Examination Date` = '1997-01-27' AND Diagnosis = 'SLE' ) AND T2.`Examination Date` = T1.`First Date`","SELECT P.Diagnosis FROM Patient P WHERE P.ID=(SELECT ID FROM Examination WHERE Diagnosis='SLE' AND ""Examination Date""='1997-01-27') AND P.""First Date""=(SELECT MIN(""First Date"") FROM Patient WHERE ID=P.ID);","0.75"
"thrombosis_prediction","simple","For the patient whose birthday was 1959/3/1, what symptoms did he/she have during the examination on 1993/9/27?","SELECT T2.Symptoms FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.Birthday = '1959-03-01' AND T2.`Examination Date` = '1993-09-27'","SELECT T3.Symptoms FROM Patient AS T1 INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T1.Birthday='1959-03-01' AND T3.""Examination Date""='1993-09-27';","0.8571428571428571"
"thrombosis_prediction","challenging","For the patient who was born on 1959/2/18, what is the decrease rate for his/her total cholesterol from November to December in 1981?","SELECT CAST((SUM(CASE WHEN T2.Date LIKE '1981-11-%' THEN T2.`T-CHO` ELSE 0 END) - SUM(CASE WHEN T2.Date LIKE '1981-12-%' THEN T2.`T-CHO` ELSE 0 END)) AS REAL) / SUM(CASE WHEN T2.Date LIKE '1981-12-%' THEN T2.`T-CHO` ELSE 0 END) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Birthday = '1959-02-18'","SELECT (L2.T-CHO-L1.T-CHO)/L1.T-CHO*100 AS Decrease_Rate FROM Patient P JOIN Laboratory L1 ON P.ID=L1.ID AND L1.Date='1981-11-01' JOIN Laboratory L2 ON P.ID=L2.ID AND L2.Date='1981-12-01' WHERE P.Birthday='1959-02-18';","0.5714285714285714"
"thrombosis_prediction","moderate","Lists all patients by ID who were diagnosed with Behcet's and had their exams between 01/01/197 and 12/31/1997.","SELECT ID FROM Examination WHERE `Examination Date` BETWEEN '1997-01-01' AND '1997-12-31' AND Diagnosis = 'Behcet'","SELECT P.ID FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.Diagnosis='Behcet''s' AND E.""Examination Date"" BETWEEN '1970-01-01' AND '1997-12-31';","0.6153846153846154"
"thrombosis_prediction","moderate","How many patients who were examined between 1987/7/6 and 1996/1/31 had a GPT level greater than 30 and an ALB level less than 4? List them by their ID.","SELECT DISTINCT ID FROM Laboratory WHERE Date BETWEEN '1987/7/6' AND '1996/1/31' AND GPT > 30 AND ALB < 4","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T3.""Examination Date"" BETWEEN '1987-07-06' AND '1996-01-31' AND T2.GPT>30 AND T2.ALB<4;","0.45"
"thrombosis_prediction","simple","How many female patients born in 1964 were admitted to the hospital? List them by ID.","SELECT ID FROM Patient WHERE STRFTIME('%Y', Birthday) = '1964' AND SEX = 'F' AND Admission = '+'","SELECT ID FROM Patient WHERE SEX='Female' AND strftime('%Y', Birthday)='1964' AND Admission IS NOT NULL;","0.8"
"thrombosis_prediction","challenging","What number of patients with a degree of thrombosis level 2 and ANA pattern of only S, have a level of anti-Cardiolip in antibody (IgM) 20% higher than average?","SELECT COUNT(T1.ID) FROM ( SELECT ID, `aCL IgM` FROM Examination WHERE Thrombosis = 2 AND `ANA Pattern` = 'S' GROUP BY ID, `aCL IgM` HAVING CAST((`aCL IgM` - AVG(`aCL IgM`)) AS REAL) / `aCL IgM` = 0.2 ) AS T1","SELECT COUNT(DISTINCT P.ID) FROM Patient P INNER JOIN Examination E ON P.ID=E.ID WHERE E.Thrombosis=2 AND E.""ANA Pattern""='S' AND E.aCL IgM>(SELECT AVG(aCL IgM)*1.2 FROM Examination);","0.6"
"thrombosis_prediction","challenging","What percentage of patients with a proteinuria level within the normal range have a uric acid level below the normal range?","SELECT CAST(SUM(CASE WHEN UA <= 6.5 THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(ID) FROM Laboratory WHERE `U-PRO` > 0 AND `U-PRO` < 30 AND UA <= 6.5","SELECT (COUNT(CASE WHEN L.UA<6 THEN 1 END)*100.0/COUNT(*)) AS percentage FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.U-PRO='Normal';","0.5625"
"thrombosis_prediction","challenging","What percentage of male patients who first presented to the hospital in 1981 were diagnosed with BEHCET?","SELECT CAST(SUM(CASE WHEN Diagnosis = 'BEHCET' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(ID) FROM Patient WHERE STRFTIME('%Y', `First Date`) = '1981' AND SEX = 'M'","SELECT (COUNT(CASE WHEN P.Diagnosis='BEHCET' THEN 1 END)*100.0/COUNT(*)) AS percentage FROM Patient P WHERE P.SEX='Male' AND strftime('%Y', P.""First Date"")='1981';","0.6875"
"thrombosis_prediction","challenging","List all patients who were followed up at the outpatient clinic who underwent a laboratory test in October 1991 and had a total blood bilirubin level within the normal range.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Admission = '-' AND T2.`T-BIL` < 2.0 AND STRFTIME('%Y', T2.Date) = '1991' AND STRFTIME('%m', T2.Date) = '10'","SELECT DISTINCT P.ID, P.SEX, P.Birthday, P.Description, P.""First Date"", P.Admission, P.Diagnosis FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE L.Date BETWEEN '1991-10-01' AND '1991-10-31' AND L.""T-BIL"" BETWEEN 0.1 AND 1.2;--Assuming normal range for total blood bilirubin is 0.1 to 1.2 mg/dL","0.2702702702702703"
"thrombosis_prediction","moderate","Excluding all P only ANA Pattern patients, how many of the remainder are women born between 1980 and 1989?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.`ANA Pattern` != 'P' AND STRFTIME('%Y', T1.Birthday) BETWEEN '1980' AND '1989' AND T1.SEX = 'F'","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE P.SEX='F' AND P.Birthday BETWEEN '1980-01-01' AND '1989-12-31' AND NOT (E.ANA=1 AND E.""ANA Pattern"" LIKE 'P%');","0.55"
"thrombosis_prediction","challenging","What sex is the patient who in a medical examination was diagnosed with PSS and in a laboratory examination had a blood level of C-reactive protein de 2+, createnine 1 and LDH 123?","SELECT T1.SEX FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID INNER JOIN Laboratory AS T3 ON T3.ID = T2.ID WHERE T2.Diagnosis = 'PSS' AND T3.CRP = '2+' AND T3.CRE = 1.0 AND LDH = 123","SELECT P.SEX FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE E.Diagnosis='PSS' AND L.CRP='2+' AND L.CRE=1 AND L.LDH=123;","0.65"
"thrombosis_prediction","moderate","What is the average blood albumin level for female patients with a PLT greater than 400 who have been diagnosed with SLE?","SELECT AVG(T2.ALB) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.PLT > 400 AND T1.Diagnosis = 'SLE' AND T1.SEX = 'F'","SELECT AVG(L.ALB) AS Average_Albumin_Level FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE P.SEX='Female' AND L.PLT>400 AND P.Diagnosis='SLE';","0.5625"
"thrombosis_prediction","simple","What is the most common sign of patients with SLE disease?","SELECT Symptoms FROM Examination WHERE Diagnosis = 'SLE' GROUP BY Symptoms ORDER BY COUNT(Symptoms) DESC LIMIT 1","SELECT Symptoms, COUNT(*) AS SymptomCount FROM Examination WHERE Diagnosis='SLE' GROUP BY Symptoms ORDER BY SymptomCount DESC LIMIT 1;","0.8571428571428571"
"thrombosis_prediction","simple","When was the medical information on patient number 48473 first documented, and what disease did she have?","SELECT `First Date`, Diagnosis FROM Patient WHERE ID = 48473","SELECT MIN(E.""Examination Date"") AS First_Documented_Date, E.""Diagnosis"" FROM Examination AS E JOIN Patient AS P ON E.ID=P.ID WHERE P.ID=48473 GROUP BY E.""Diagnosis"";","0.4444444444444444"
"thrombosis_prediction","simple","How many female patients were given an APS diagnosis?","SELECT COUNT(ID) FROM Patient WHERE SEX = 'F' AND Diagnosis = 'APS'","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE P.SEX='Female' AND E.Diagnosis='APS';","0.5"
"thrombosis_prediction","simple","How many patients who underwent testing in 1997 had protein levels outside the normal range?","SELECT COUNT(ID) FROM Laboratory WHERE ALB <= 6.0 OR ALB >= 8.5 AND STRFTIME('%Y', Date) = '1997'","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.Date BETWEEN '1997-01-01' AND '1997-12-31' AND (T2.ALB<3.5 OR T2.ALB>5.0);","0.35294117647058826"
"thrombosis_prediction","moderate","What proportion of patients who had signs of thrombocytopenia had SLE diagnosed?","SELECT CAST(SUM(CASE WHEN Diagnosis = 'SLE' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(ID) FROM Examination WHERE Symptoms = 'thrombocytopenia'","SELECT (SELECT COUNT(*) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.Thrombosis<3 AND E.Thrombosis>0) AS TotalPatientsWithThrombocytopenia, (SELECT COUNT(*) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.Thrombosis<3 AND E.Thrombosis>0 AND P.Diagnosis='SLE') AS PatientsWithSLE, (SELECT COUNT(*) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.Thrombosis<3 AND E.Thrombosis>0 AND P.Diagnosis='SLE')*1.0/(SELECT COUNT(*) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.Thrombosis<3 AND E.Thrombosis>0) AS ProportionWithSLE","0.35294117647058826"
"thrombosis_prediction","moderate","What percentage of patients who were born in 1980 and were diagnosed with RA are women?","SELECT CAST(SUM(CASE WHEN SEX = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(ID) FROM Patient WHERE Diagnosis = 'RA' AND SEX = 'F' AND STRFTIME('%Y', Birthday) = '1980'","SELECT (COUNT(CASE WHEN P.SEX='Female' THEN 1 END)*100.0/COUNT(*)) AS percentage_women FROM Patient P WHERE strftime('%Y', P.Birthday)='1980' AND P.Diagnosis='RA';","0.6875"
"thrombosis_prediction","challenging","How many male patients who underwent testing between 1995 and 1997 and were subsequently diagnosed with BEHCET disease did not stay in the hospital for treatment?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.Diagnosis = 'Behcet' AND T1.SEX = 'M' AND STRFTIME('%Y', T2.`Examination Date`) BETWEEN '1995' AND '1997' AND T1.Admission = '-'","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE P.SEX='Male' AND E.""Examination Date"" BETWEEN '1995-01-01' AND '1997-12-31' AND E.Diagnosis='BEHCET' AND P.Admission IS NULL;","0.45"
"thrombosis_prediction","simple","How many patients who were female got white blood cells that were below 3.5?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.WBC < 3.5 AND T1.SEX = 'F'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Female' AND T2.WBC<3.5;","0.8181818181818182"
"thrombosis_prediction","simple","How long did it take after patient number 821298 arrived at the hospital for the first time before her evaluation began?","SELECT STRFTIME('%d', T3.`Examination Date`) - STRFTIME('%d', T1.`First Date`) FROM Patient AS T1 INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T1.ID = 821298","SELECT JULIANDAY(E.""Examination Date"")-JULIANDAY(P.""First Date"") AS Days_Between_Arrival_and_Evaluation FROM Patient AS P JOIN Examination AS E ON P.ID=E.ID WHERE P.ID=821298 ORDER BY E.""Examination Date"" LIMIT 1;","0.35714285714285715"
"thrombosis_prediction","moderate","Was the patient with the number 57266's uric acid within a normal range?","SELECT CASE WHEN (T1.SEX = 'F' AND T2.UA < 6.5) OR (T1.SEX = 'M' AND T2.UA < 8.0) THEN true ELSE false END FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.ID = 57266","SELECT UA FROM Laboratory WHERE ID=57266;","0.2857142857142857"
"thrombosis_prediction","simple","When is the laboratory examination of patient '48473' where his/her AST glutamic oxaloacetic transaminase (GOT) index is above the normal range.","SELECT Date FROM Laboratory WHERE ID = 48473 AND GOT >= 60","SELECT L.Date FROM Laboratory AS L INNER JOIN Patient AS P ON L.ID=P.ID WHERE P.ID=48473 AND L.GOT>40;--Assuming 40 is the upper normal range for GOT","0.26666666666666666"
"thrombosis_prediction","moderate","List all patients with their sex and date of birthday, whose AST glutamic oxaloacetic transaminase (GOT) index is within normal range for loboratory examination in 1994.","SELECT DISTINCT T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GOT < 60 AND STRFTIME('%Y', T2.Date) = '1994'","SELECT P.SEX, P.Birthday FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.GOT BETWEEN 0 AND 40 AND L.Date BETWEEN '1994-01-01' AND '1994-12-31';","0.3684210526315789"
"thrombosis_prediction","moderate","Provide IDs for male patients with ALT glutamic pylvic transaminase (GPT) that have history of ALT glutamic pylvic transaminase (GPT) exceed the normal range.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'M' AND T2.GPT >= 60","SELECT DISTINCT P.ID FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE P.SEX='Male' AND L.GPT>40;","0.38461538461538464"
"thrombosis_prediction","moderate","Please provide the diagnosis of patients with ALT glutamic pylvic transaminase beyond the normal range by ascending order of their date of birth.","SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'M' AND T2.GPT >= 60 ORDER BY T1.Birthday ASC","SELECT P.Diagnosis FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.GPT>40 ORDER BY P.Birthday ASC;","0.4666666666666667"
"thrombosis_prediction","simple","What is the average index of the lactate dehydrogenase (LDH) for all patients with lactate dehydrogenase (LDH) within the normal range.","SELECT AVG(LDH) FROM Laboratory WHERE LDH < 500","SELECT AVG(LD.LDH) AS Average_LDH FROM Laboratory AS LD WHERE LD.LDH BETWEEN 140 AND 280;--Assuming normal range for LDH is 140-280 U/L","0.15384615384615385"
"thrombosis_prediction","moderate","Provide the ID and age of patient with lactate dehydrogenase (LDH) between 100-300 index above the normal range.","SELECT DISTINCT T1.ID, STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.LDH > 600 AND T2.LDH < 800","SELECT P.ID, strftime('%Y', 'now')-strftime('%Y', P.Birthday) AS Age FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.LDH>100 AND L.LDH<300;","0.3888888888888889"
"thrombosis_prediction","moderate","For patients with alkaliphophatase (ALP) within normal range, were they treated as inpatient or outpatient?","SELECT T1.Admission FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.ALP < 300","SELECT T1.Admission, COUNT(T1.ID) AS PatientCount FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.ALP BETWEEN 30 AND 120--Assuming normal range for ALP is 30-120 GROUP BY T1.Admission;","0.4666666666666667"
"thrombosis_prediction","moderate","Name the ID of the patient who is born on the April 1st, 1982. Is his/her alkaliphophatase (ALP) within normal range?","SELECT T1.ID , CASE WHEN T2.ALP < 300 THEN 'Normal' ELSE 'abNormal' END FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Birthday = '1982-04-01'","SELECT P.ID, L.ALP FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE P.Birthday='1982-04-01' AND L.ALP BETWEEN 30 AND 120;","0.47058823529411764"
"thrombosis_prediction","simple","List ID, sex and date of birth of patient whose total protein (TP) below the lower range of the normal index.","SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TP < 6.0","SELECT P.ID, P.SEX, P.Birthday FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.TP<(SELECT MIN(TP) FROM Laboratory);","0.5"
"thrombosis_prediction","moderate","For all female patient with total protein (TP) beyond the normal index, what is the deviation of their TP idex from the normal.","SELECT T2.TP - 8.5 FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'F' AND T2.TP >= 8.5","SELECT P.ID, L.TP, (L.TP-7.0) AS TP_Deviation FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE P.SEX='Female' AND L.TP>7.0;","0.3125"
"thrombosis_prediction","simple","Sort in descending order all patients by birthday for male patient with albumin not within range.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'M' AND (T2.ALB <= 3.5 OR T2.ALB >= 5.5) ORDER BY T1.Birthday","SELECT P.*FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE P.SEX='Male' AND (L.ALB<3.5 OR L.ALB>5.0) ORDER BY P.Birthday DESC;","0.5"
"thrombosis_prediction","moderate","For all patient born in 1982, state if their albumin is within normal range.","SELECT CASE WHEN T2.ALB > 3.5 AND T2.ALB < 5.5 THEN 'normal' ELSE 'abnormal' END FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T1.Birthday) = '1982'","SELECT P.ID, CASE WHEN L.ALB BETWEEN 3.5 AND 5.0 THEN 'Within Normal Range' ELSE 'Outside Normal Range' END AS Albumin_Status FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE strftime('%Y', P.Birthday)='1982';","0.5238095238095238"
"thrombosis_prediction","moderate","What is the percentage of the female patient whose uric acid (UA) beyond the normal range?","SELECT CAST(SUM(CASE WHEN T2.UA > 6.5 AND T1.SEX = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / SUM(CASE WHEN T2.UA > 8.0 AND T1.SEX = 'M' OR T2.UA > 6.5 AND T1.SEX = 'F' THEN 1 ELSE 0 END) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID","SELECT (COUNT(CASE WHEN L.UA>7 THEN 1 END)*100.0/COUNT(*)) AS female_percentage_above_normal FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE P.SEX='Female';","0.4"
"thrombosis_prediction","moderate","For all patients with normal uric acid (UA), what is the average UA index based on their latest laboratory examination result?","SELECT AVG(T2.UA) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE (T2.UA > 6.5 AND T1.SEX = 'F') OR T2.UA > 8.0 AND T1.SEX = 'M' AND T2.Date = ( SELECT MAX(Date) FROM Laboratory )","SELECT AVG(L.UA) AS Average_UA FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.UA BETWEEN 3.5 AND 7.2 AND L.Date=(SELECT MAX(Date) FROM Laboratory WHERE ID=P.ID);","0.2631578947368421"
"thrombosis_prediction","simple","Provide all ID, sex and birthday of patients whose urea nitrogen (UN) just within the borderline of passing?","SELECT DISTINCT T1.ID, T1.Birthday, T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.UN = 29","SELECT P.ID, P.SEX, P.Birthday FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.UN BETWEEN 7 AND 20;","0.46153846153846156"
"thrombosis_prediction","simple","Provide the ID, sex, birthday of all patients diagnosed with 'RA' that are within the UN normal index.","SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.UN < 30 AND T1.Diagnosis = 'RA'","SELECT P.ID, P.SEX, P.Birthday FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE P.Diagnosis='RA' AND L.UN<100;","0.5714285714285714"
"thrombosis_prediction","simple","How many male patients are are with creatinine index out of the normal range?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.CRE >= 1.5 AND T1.SEX = 'M'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Male' AND (T2.CRE<0.6 OR T2.CRE>1.2);","0.5714285714285714"
"thrombosis_prediction","challenging","Are there more male patients with creatinine not within the normal range than female? True or False?","SELECT CASE WHEN SUM(CASE WHEN T1.SEX = 'M' THEN 1 ELSE 0 END) > SUM(CASE WHEN T1.SEX = 'F' THEN 1 ELSE 0 END) THEN 'True' ELSE 'False' END FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.CRE >= 1.5","SELECT SUM(CASE WHEN P.SEX='Male' THEN 1 ELSE 0 END) AS Male_Count, SUM(CASE WHEN P.SEX='Female' THEN 1 ELSE 0 END) AS Female_Count FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.CRE<0.6 OR L.CRE>1.2;--Assuming normal range for creatinine is 0.6 to 1.2 mg/dL","0.25"
"thrombosis_prediction","simple","What is the highest total bilirubin level recorded? List out the patient details with ID, sex and birthday with that index.","SELECT T2.`T-BIL`, T1.ID, T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID ORDER BY T2.`T-BIL` DESC LIMIT 1","SELECT P.ID, P.SEX, P.Birthday FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.T-BIL=(SELECT MAX(T-BIL) FROM Laboratory);","0.5384615384615384"
"thrombosis_prediction","moderate","List and group all patients by sex for total bilirubin (T-BIL) level not within the normal range.","SELECT DISTINCT CASE WHEN T1.SEX = 'F' THEN T1.ID END , CASE WHEN T1.SEX = 'M' THEN T1.ID END FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`T-BIL` >= 2.0","SELECT P.SEX, COUNT(P.ID) AS Patient_Count FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.""T-BIL""<1.2 OR L.""T-BIL"">1.9 GROUP BY P.SEX;","0.4117647058823529"
"thrombosis_prediction","simple","Who is the oldest patient with the highest total cholesterol (T-CHO). State the patient ID and T-CHO index.","SELECT T1.ID, T2.`T-CHO` FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID ORDER BY T2.`T-CHO` DESC, T1.Birthday ASC LIMIT 1","SELECT P.ID, L.""T-CHO"" FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE P.Birthday=(SELECT MIN(Birthday) FROM Patient WHERE ID IN (SELECT ID FROM Laboratory ORDER BY ""T-CHO"" DESC LIMIT 1)) ORDER BY L.""T-CHO"" DESC LIMIT 1;","0.6153846153846154"
"thrombosis_prediction","moderate","What is the average age of the male patient with high cholesterol?","SELECT AVG(STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday)) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`T-CHO` >= 250 AND T1.SEX = 'M'","SELECT AVG(JULIANDAY('now')-JULIANDAY(P.Birthday))/365.25 AS Average_Age FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE P.SEX='Male' AND L.T-CHO>240;","0.30434782608695654"
"thrombosis_prediction","simple","Provide list of patients and their diagnosis with triglyceride (TG) index greater than 100 of the normal range?","SELECT T1.ID, T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TG > 300","SELECT P.ID, P.Diagnosis, L.TG FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.TG>100;","0.45454545454545453"
"thrombosis_prediction","moderate","For all patients with triglyceride (TG) level beyond the normal range, how many are age more than 50 years?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TG > 200 AND STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) > 50","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.TG>150 AND (julianday('now')-julianday(P.Birthday))/365.25>50;","0.3157894736842105"
"thrombosis_prediction","simple","List all outpatient within normal range of creatinine phosphokinase. Give me the distinct ids.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.CPK < 250 AND T1.Admission = '-'","SELECT DISTINCT P.ID FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.CPK BETWEEN 0 AND 200;--Assuming normal range for CPK is 0 to 200","0.23529411764705882"
"thrombosis_prediction","challenging","For patient born between 1936-1956, how many male patients have creatinine phosphokinase beyond the normal range?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T1.Birthday) BETWEEN '1936' AND '1956' AND T1.SEX = 'M' AND T2.CPK >= 250","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Male' AND T1.Birthday BETWEEN '1936-01-01' AND '1956-12-31' AND T2.CPK>200;--Assuming 200 is the upper limit for normal CPK levels","0.4"
"thrombosis_prediction","challenging","Provide ID, sex and age of patient who has blood glucose (GLU) not within normal range but with total cholesterol(T-CHO) within normal range.","SELECT DISTINCT T1.ID, T1.SEX , STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GLU >= 180 AND T2.`T-CHO` < 250","SELECT P.ID, P.SEX, strftime('%Y', 'now')-strftime('%Y', P.Birthday) AS AGE FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.GLU NOT BETWEEN 70 AND 100 AND L.T_CHO BETWEEN 125 AND 200;","0.3333333333333333"
"thrombosis_prediction","moderate","List each patient's ID and blood glucose (GLU) index that were within normal range for patient's whose data was first recorded in 1991.","SELECT DISTINCT T1.ID, T2.GLU FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T1.`First Date`) = '1991' AND T2.GLU < 180","SELECT P.ID, L.GLU FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE P.""First Date"">='1991-01-01' AND P.""First Date""<'1992-01-01' AND L.GLU BETWEEN 70 AND 140;","0.35294117647058826"
"thrombosis_prediction","moderate","List the patient ID, sex and birthday who has abnormal white blood cell count. Group them by sex and list the patient by age in ascending order.","SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.WBC <= 3.5 OR T2.WBC >= 9.0 ORDER BY T1.Birthday DESC","SELECT P.ID, P.SEX, P.Birthday FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.WBC>11 OR L.WBC<4 GROUP BY P.SEX, P.ID, P.Birthday ORDER BY P.SEX, DATE('now')-P.Birthday;","0.3333333333333333"
"thrombosis_prediction","moderate","What are the patient's diagnosis for those who has lower red blood blood cell? State their ID and age.","SELECT T1.Diagnosis, T1.ID , STRFTIME('%Y', CURRENT_TIMESTAMP) -STRFTIME('%Y', T1.Birthday) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RBC < 3.5","SELECT P.ID, strftime('%Y', 'now')-strftime('%Y', P.Birthday) AS Age, L.RBC, E.Diagnosis FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE L.RBC<4.5;--Assuming 4.5 is the threshold for lower red blood cell count","0.32142857142857145"
"thrombosis_prediction","challenging","For all the female patient age 50 and above, who has abnormal red blood cell count. State if they were admitted to hospital.","SELECT DISTINCT T1.ID, T1.Admission FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'F' AND (T2.RBC <= 3.5 OR T2.RBC >= 6.0) AND STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) >= 50","SELECT P.ID, P.SEX, P.Birthday, P.Admission, L.RBC FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE P.SEX='Female' AND (strftime('%Y', 'now')-strftime('%Y', P.Birthday))>=50 AND L.RBC<4.2;--Assuming 4.2 is the threshold for abnormal RBC count","0.3448275862068966"
"thrombosis_prediction","simple","Among all outpatients, list out those have low hemoglobin level. State the different IDs and their sex.","SELECT DISTINCT T1.ID, T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.HGB < 10 AND T1.Admission = '-'","SELECT DISTINCT P.ID, P.SEX FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.HGB<13.5;","0.38461538461538464"
"thrombosis_prediction","moderate","Among the patients who were diagnosed with SLE, who is the oldest with normal hemoglobin level. Provide the ID and sex.","SELECT T1.ID, T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Diagnosis = 'SLE' AND T2.HGB > 10 AND T2.HGB < 17 ORDER BY T1.Birthday ASC LIMIT 1","SELECT P.ID, P.SEX FROM Patient P INNER JOIN Examination E ON P.ID=E.ID INNER JOIN Laboratory L ON P.ID=L.ID WHERE P.Diagnosis='SLE' AND L.HGB>=13 ORDER BY P.Birthday LIMIT 1;","0.47368421052631576"
"thrombosis_prediction","challenging","Name the ID and age of patient with two or more laboratory examinations which show their hematoclit level exceeded the normal range.","SELECT DISTINCT T1.ID, STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.ID IN ( SELECT ID FROM Laboratory WHERE HCT > 52 GROUP BY ID HAVING COUNT(ID) >= 2 )","SELECT P.ID, strftime('%Y', 'now')-strftime('%Y', P.Birthday) AS Age FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.HCT>45--Assuming 45 is the upper limit for normal hematocrit level GROUP BY P.ID HAVING COUNT(L.ID)>=2;","0.3333333333333333"
"thrombosis_prediction","moderate","From laboratory examinations in 1991, what is the average hematoclit level that is lower than the normal range.","SELECT AVG(T2.HCT) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.HCT < 29 AND STRFTIME('%Y', T2.Date) = '1991'","SELECT AVG(HCT) AS Average_Hematocrit FROM Laboratory WHERE Date BETWEEN '1991-01-01' AND '1991-12-31' AND HCT<40;","0.2"
"thrombosis_prediction","challenging","For patients with abnormal platelet level, state the number of patients with lower than normal range. How is it compare to the number of patients with higher than normal range?","SELECT SUM(CASE WHEN T2.PLT < 100 THEN 1 ELSE 0 END) - SUM(CASE WHEN T2.PLT > 400 THEN 1 ELSE 0 END) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID","SELECT SUM(CASE WHEN L.PLT<150 THEN 1 ELSE 0 END) AS Lower_Than_Normal, SUM(CASE WHEN L.PLT>450 THEN 1 ELSE 0 END) AS Higher_Than_Normal FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.PLT<150 OR L.PLT>450;","0.375"
"thrombosis_prediction","challenging","For laboratory examinations take in 1984, list all patients below 50 years old with normal platelet level.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.PLT > 100 AND T2.PLT < 400 AND STRFTIME('%Y', T2.Date) - STRFTIME('%Y', T1.Birthday) < '50' AND STRFTIME('%Y', T2.Date) = '1984'","SELECT P.ID, P.SEX, P.Birthday FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.""Examination Date"" BETWEEN '1984-01-01' AND '1984-12-31' AND (strftime('%Y', 'now')-strftime('%Y', P.Birthday))<50 AND L.PLT BETWEEN 150 AND 450;","0.375"
"thrombosis_prediction","challenging","For all patients who are older than 55 years old, what is the percentage of female who has abnormal prothrombin time (PT)?","SELECT CAST(SUM(CASE WHEN T2.PT >= 14 AND T1.SEX = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(*) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T1.Birthday) > 55","SELECT (COUNT(CASE WHEN P.SEX='Female' AND L.PT>14 THEN 1 END)*100.0/COUNT(*)) AS Female_Abnormal_PT_Percentage FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE (julianday('now')-julianday(P.Birthday))/365.25>55;","0.44"
"thrombosis_prediction","challenging","List all patients who first came to the hospital after year 1992 with prothrombin time (PT) level that are normal. Sort the ID by the date of laboratory examiniation.","SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE STRFTIME('%Y', T1.`First Date`) = '1992' AND T2.PT < 14 ORDER BY T1.ID","SELECT P.ID, L.Date FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE P.""First Date"">'1992-12-31' AND L.PT BETWEEN 10 AND 14 ORDER BY L.Date;","0.4375"
"thrombosis_prediction","moderate","For the examinations done after 1997/1/1, how many of them have the result of an inactivated partial prothrom bin time?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.Date > '1997-01-01' AND T2.APTT >= 45","SELECT COUNT(ID) FROM Examination WHERE ""Examination Date"">'1997-01-01' AND KCT='inactivated partial prothrombin time'","0.2"
"thrombosis_prediction","moderate","For the patients with an abnormal activated partial prothrom bin time, how many of them have a mild thrombosis?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE T3.Thrombosis = 3 AND T2.APTT < 45","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.APTT>40 AND T3.Thrombosis=1;","0.6923076923076923"
"thrombosis_prediction","challenging","Among the male patients who have a normal level of white blood cells, how many of them have an abnormal fibrinogen level?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.FG <= 150 OR T2.FG >= 450 AND T2.WBC > 3.5 AND T2.WBC < 9.0 AND T1.SEX = 'M'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Male' AND T2.WBC BETWEEN 4.0 AND 11.0 AND T2.FG NOT BETWEEN 200 AND 400;","0.45"
"thrombosis_prediction","moderate","How many patients born after 1980/1/1 have an abnormal fibrinogen level?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.FG <= 150 OR T2.FG >= 450 AND T1.Birthday > '1980-01-01'","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE P.Birthday>'1980-01-01' AND L.FG<200;","0.5"
"thrombosis_prediction","simple","Please list the disease names of the patients that have a proteinuria level higher than normal.","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`U-PRO` >= 30","SELECT DISTINCT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.U-PRO='Positive' OR T2.U-PRO='High';","0.7272727272727273"
"thrombosis_prediction","moderate","Which patient has a normal proteinuria level and is diagnosed with SLE? Please give his or her patient ID.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`U-PRO` > 0 AND T2.`U-PRO` < 30 AND T1.Diagnosis = 'SLE'","SELECT P.ID FROM Patient P INNER JOIN Examination E ON P.ID=E.ID INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.U-PRO='Normal' AND P.Diagnosis='SLE';","0.4375"
"thrombosis_prediction","moderate","How many patients with an Ig G lower than normal has the symptom of abortion?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE T2.IGG < 900 AND T3.Symptoms = 'abortion'","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.IGG<7 AND T3.Symptoms LIKE '%abortion%'","0.8333333333333334"
"thrombosis_prediction","moderate","Among the patients with a normal Ig G level, how many of them have symptoms?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE T2.IGG BETWEEN 900 AND 2000 AND T3.Symptoms IS NOT NULL","SELECT COUNT(T3.ID) FROM Examination AS T3 WHERE T3.""aCL IgG"" IS NOT NULL AND T3.""aCL IgG"" BETWEEN 7 AND 13 AND T3.Symptoms IS NOT NULL;","0.35714285714285715"
"thrombosis_prediction","simple","For the patient who has the highest Ig A within the normal range, what is his or her diagnosis?","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.IGA BETWEEN 80 AND 500 ORDER BY T2.IGA DESC LIMIT 1","SELECT T3.Diagnosis FROM Examination AS T3 WHERE T3.aCL_IgA=( SELECT MAX(T3_sub.aCL_IgA) FROM Examination AS T3_sub WHERE T3_sub.aCL_IgA<=(SELECT MAX(aCL_IgA) FROM Examination) )","0.06666666666666667"
"thrombosis_prediction","moderate","How many patients with a normal Ig A level came to the hospital after 1990/1/1?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.IGA BETWEEN 80 AND 500 AND T1.`First Date` > '1990-01-01'","SELECT COUNT(DISTINCT P.ID) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID WHERE E.""Examination Date"">'1990-01-01' AND E.""aCL IgA""=0;","0.3125"
"thrombosis_prediction","moderate","For the patients with an abnormal Ig M level, what is the most common disease they are diagnosed with?","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.IGM NOT BETWEEN 40 AND 400 GROUP BY T1.Diagnosis ORDER BY COUNT(T1.Diagnosis) DESC LIMIT 1","SELECT Diagnosis, COUNT(*) AS DiagnosisCount FROM Examination WHERE aCL IgM>abnormal_value--Replace abnormal_value with the actual threshold for abnormal IgM levels GROUP BY Diagnosis ORDER BY DiagnosisCount DESC LIMIT 1;","0.17391304347826086"
"thrombosis_prediction","moderate","How many patients with a normal C-reactive protein don't have their data recorded?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE (T2.CRP = '-' OR T2.CRP = '+-' OR T2.CRP < 1.0) AND T1.Description IS NULL","SELECT COUNT(P.ID) FROM Patient AS P LEFT JOIN Laboratory AS L ON P.ID=L.ID WHERE L.CRP='Normal' AND L.ID IS NULL;","0.3333333333333333"
"thrombosis_prediction","challenging","Among the patients whose C-reactive protein level is abnormal, how many of them aren't 18 yet?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE (T2.CRP != '-' OR T2.CRP != '+-') AND T2.CRP >= 1.0 AND STRFTIME('%Y', T2.Date) - STRFTIME('%Y', T1.Birthday) < '18'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.CRP='abnormal' AND DATE('now')-DATE(T1.Birthday)<18*365","0.5333333333333333"
"thrombosis_prediction","moderate","How many patients with a normal Rhuematoid Factor has a positive measure of degree of coagulation?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE (T2.RA = '-' OR '+-') AND T3.KCT = '+'","SELECT COUNT(DISTINCT P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE L.RF='Normal' AND L.FG>0;","0.25"
"thrombosis_prediction","moderate","Please list the diseases of the patients born after 1995-1-1 and have a normal Rhuematoid Factor.","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE (T2.RA = '-' OR '+-') AND T1.Birthday > 1995-01-01","SELECT DISTINCT T3.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T1.Birthday>'1995-01-01' AND T2.RF='Normal';","0.6428571428571429"
"thrombosis_prediction","simple","Please list the ID of the patient whose RF is normal and who is older than 60.","SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RF < 20 AND STRFTIME('%Y', T2.Date) - STRFTIME('%Y', T1.Birthday) > 60","SELECT P.ID FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.RF='normal' AND (julianday('now')-julianday(P.Birthday))/365>60;","0.35294117647058826"
"thrombosis_prediction","simple","How many patients with a normal RF don't have thrombosis?","SELECT COUNT(DISTINCT T1.ID) FROM Examination AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RF < 20 AND T1.Thrombosis = 0","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.RF='normal' AND T3.Thrombosis=0;","0.6666666666666666"
"thrombosis_prediction","moderate","How many patients with a normal level of complement 3 have a P pattern observed in the sheet of ANA examination?","SELECT COUNT(DISTINCT T1.ID) FROM Examination AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.C3 > 35 AND T1.`ANA Pattern` = 'P'","SELECT COUNT(DISTINCT P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE L.C3 IS NOT NULL AND L.C3='normal' AND E.""ANA Pattern""='P';","0.5"
"thrombosis_prediction","moderate","Among the patients whose level of complement 3 isn't normal, which patient has the highest anti-Cardiolipin antibody concentration? Please list his or her ID.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.C3 <= 35 ORDER BY T2.IGA DESC LIMIT 1","SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.C3<>'normal' ORDER BY T3.aCL IgG DESC LIMIT 1;","0.5333333333333333"
"thrombosis_prediction","moderate","Among the patients have blood clots in veins, how many of them have a normal level of complement 4?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.C4 > 10 AND T1.Diagnosis = 'APS'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T3.Thrombosis=1 AND T2.C4 BETWEEN 10 AND 40;","0.5"
"thrombosis_prediction","moderate","How many patients have a normal level of anti-ribonuclear protein and have been admitted to the hospital?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RNP = 'negative' OR T2.RNP = '0' AND T1.Admission = '+'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.RNP='normal' AND T1.Admission IS NOT NULL;","0.7"
"thrombosis_prediction","moderate","Which is the youngest patient with an abnormal anti-ribonuclear protein level? Please list his or her date of birth.","SELECT T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RNP != '-' OR '+-' ORDER BY T1.Birthday DESC LIMIT 1","SELECT P.Birthday FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.RNP='abnormal' ORDER BY P.Birthday DESC LIMIT 1;","0.5833333333333334"
"thrombosis_prediction","moderate","Among the patients with normal anti-SM, how many of them have the most severe degree of thrombosis?","SELECT COUNT(T1.ID) FROM Examination AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SM = 'negative' OR '0' AND T1.Thrombosis = 1","SELECT COUNT(*) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE L.SM='Normal' AND E.Thrombosis=(SELECT MAX(Thrombosis) FROM Examination WHERE Thrombosis IS NOT NULL);","0.3333333333333333"
"thrombosis_prediction","simple","For the patients with an abnormal anti-SM, please list the IDs of the three youngest ones.","SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SM != '-' OR T2.SM != '+-' ORDER BY T1.Birthday DESC LIMIT 3","SELECT P.ID FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.SM='abnormal' ORDER BY P.Birthday DESC LIMIT 3;","0.5833333333333334"
"thrombosis_prediction","moderate","Please list the IDs of the patients who had the examination done after 1997/1/1 and had a normal anti-scl70.","SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SC170 = 'negative' AND T2.Date > 1997-01-01","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T3.""Examination Date"">'1997-01-01' AND T3.""aCL IgG"" IS NULL;","0.38461538461538464"
"thrombosis_prediction","challenging","Among the patients who has a normal anti-scl70, how many of them are male and have the symptom of vertigo?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE T2.SC170 = '-' OR T2.SC170 = '+-' AND T1.SEX = 'M' AND T3.Symptoms = 'vertigo'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T1.SEX='Male' AND T3.Symptoms LIKE '%vertigo%' AND T3.aCL IgG IS NULL;","0.5333333333333333"
"thrombosis_prediction","moderate","How many patients with a normal anti-SSA came to the hospital before 1990?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SSA = 'negative' OR '0' AND STRFTIME('%Y', T2.Date) < '1990'","SELECT COUNT(DISTINCT P.ID) FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.SSA='normal' AND P.First_Date<'1990-01-01';","0.3125"
"thrombosis_prediction","moderate","Which patient is the first patient with an abnormal anti-SSA to come to the hospital? Please give his or her ID.","SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SSA != 'negative' OR T2.SSA != '0' ORDER BY T1.`First Date` ASC LIMIT 1","SELECT P.ID FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.SSA='abnormal' ORDER BY P.""First Date"" LIMIT 1;","0.42857142857142855"
"thrombosis_prediction","moderate","How many patients have a normal anti-SSB and are diagnosed with SLE in the examination?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SSB = 'negative' OR '0' AND T1.Diagnosis = 'SLE'","SELECT COUNT(T3.ID) FROM Examination AS T3 WHERE T3.Diagnosis='SLE' AND T3.SSB='normal'","0.3076923076923077"
"thrombosis_prediction","moderate","For the patients whose anti-SSB are normal, how many of them have other symptoms observed in their examination?","SELECT COUNT(DISTINCT T1.ID) FROM Examination AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SSB = 'negative' OR '0' AND T1.Symptoms IS NOT NULL","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.SSB='normal' AND T3.Symptoms IS NOT NULL;","0.5833333333333334"
"thrombosis_prediction","moderate","Among the patients who has a normal level of anti-centromere and a normal level of anti-SSB, how many of them are male?","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.CENTROMEA = 'negative' OR '0' AND T2.SSB = 'negative' OR '0' AND T1.SEX = 'M'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Male' AND T2.CENTROMEA='Normal' AND T2.SSB='Normal';","0.6153846153846154"
"thrombosis_prediction","simple","For the patients who have an abnormal level of anti-DNA, please list the diseases they are diagnosed with.","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA >= 8 GROUP BY T1.ID, T1.Diagnosis","SELECT DISTINCT T3.Diagnosis FROM Examination AS T3 INNER JOIN Laboratory AS T2 ON T3.ID=T2.ID WHERE T2.DNA='abnormal';","0.45454545454545453"
"thrombosis_prediction","moderate","How many patients have a normal anti-DNA level, yet their data are not recorded.","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.DNA < 8 AND T1.Description IS NULL","SELECT COUNT(P.ID) FROM Patient AS P LEFT JOIN Laboratory AS L ON P.ID=L.ID LEFT JOIN Examination AS E ON P.ID=E.ID WHERE L.DNA='Normal' AND E.ID IS NULL;","0.3076923076923077"
"thrombosis_prediction","simple","Of the patients with an abnormal level of anti-DNA-II, how many of them admitted to the hospital?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`DNA-II` >= 8 AND T1.Admission = '+'","SELECT COUNT(DISTINCT P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.""DNA-II"">0 AND P.Admission IS NOT NULL;","0.5"
"thrombosis_prediction","moderate","What is the percentage of patient who has a normal anti-DNA-II level, yet he or she is diagnosed with SLE?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.`DNA-II` < 8 AND T1.Diagnosis LIKE '%SLE%'","SELECT (COUNT(CASE WHEN T2.""DNA-II""='Normal' AND T1.Diagnosis='SLE' THEN 1 END)*100.0)/COUNT(CASE WHEN T1.Diagnosis='SLE' THEN 1 END) AS percentage_normal_dna_sle FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.Diagnosis='SLE';","0.6"
"thrombosis_prediction","simple","How many male patients have their glutamic oxaloacetic transaminase in the normal range?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GOT < 60 AND T1.SEX = 'M'","SELECT COUNT(P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE P.SEX='Male' AND L.GOT BETWEEN 0 AND 40;","0.35714285714285715"
"thrombosis_prediction","moderate","Among the patients who have an abnormal level of glutamic oxaloacetic transaminase, when was the youngest of them born?","SELECT T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GOT >= 60 ORDER BY T1.Birthday DESC LIMIT 1","SELECT MIN(P.Birthday) AS Youngest_Birthday FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.GOT>40;--Assuming 40 is the threshold for abnormal levels of GOT","0.23809523809523808"
"thrombosis_prediction","simple","Please list the top three patients' birthdays with the highest glutamic pylvic transaminase in the normal range.","SELECT T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GPT < 60 ORDER BY T2.GPT DESC LIMIT 3","SELECT P.Birthday FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.GPT BETWEEN 0 AND 40--Assuming normal range for GPT is 0-40 ORDER BY L.GPT DESC LIMIT 3;","0.3888888888888889"
"thrombosis_prediction","simple","For the patients with the normal glutamic pylvic transaminase level, how many of them are male?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GOT < 60 AND T1.SEX = 'M'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.GPT BETWEEN 7 AND 56 AND T1.SEX='Male';","0.46153846153846156"
"thrombosis_prediction","moderate","For the patient with the highest lactate dehydrogenase in the normal range, when was his or her data first recorded?","SELECT T1.`First Date` FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.LDH < 500 ORDER BY T2.LDH DESC LIMIT 1","SELECT MIN(L.Date) AS First_Record_Date FROM Laboratory L JOIN Patient P ON L.ID=P.ID WHERE L.LDH<=250--Assuming 250 is the upper limit of the normal range for LDH AND L.LDH=(SELECT MAX(LDH) FROM Laboratory WHERE LDH<=250);","0.19047619047619047"
"thrombosis_prediction","moderate","When is the latest patient's medical data recorded? This patient should have an abnormal level of lactate dehydrogenase.","SELECT T1.`First Date` FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.LDH >= 500 ORDER BY T1.`First Date` DESC LIMIT 1","SELECT MAX(L.Date) AS Latest_Medical_Data FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.LDH>250;--Assuming 250 is the threshold for abnormal LDH levels","0.2"
"thrombosis_prediction","simple","For the patient with an abnormal alkaliphophatase level, how many of them are admitted to the hospital?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.ALP >= 300 AND T1.Admission = '+'","SELECT COUNT(DISTINCT P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE L.ALP>120 AND P.Admission IS NOT NULL;","0.45454545454545453"
"thrombosis_prediction","moderate","Among the patients followed at the outpatient clinic, how many of them have a normal level of alkaliphophatase?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.ALP < 300 AND T1.Admission = '-'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.ALP BETWEEN 30 AND 120;","0.6"
"thrombosis_prediction","simple","Please list the diagnosis of the patients whose total protein is lower than normal.","SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TP < 6.0","SELECT T3.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.TP<6.0;","0.8181818181818182"
"thrombosis_prediction","moderate","For the patients who are diagnosed with SJS, how many of them have a normal level of total protein?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Diagnosis = 'SJS' AND T2.TP > 6.0 AND T2.TP < 8.5","SELECT COUNT(DISTINCT P.ID) FROM Patient AS P INNER JOIN Examination AS E ON P.ID=E.ID INNER JOIN Laboratory AS L ON P.ID=L.ID WHERE E.Diagnosis='SJS' AND L.TP BETWEEN 6.0 AND 8.0;","0.5625"
"thrombosis_prediction","simple","What is the examination date of the patient whose albumin is the highest in the normal range?","SELECT Date FROM Laboratory WHERE ALB BETWEEN 3.5 AND 5.5 ORDER BY ALB DESC LIMIT 1","SELECT E.""Examination Date"" FROM Examination AS E JOIN Laboratory AS L ON E.ID=L.ID WHERE L.ALB=(SELECT MAX(ALB) FROM Laboratory WHERE ALB<=5.0)--Assuming 5.0 is the upper limit of normal range for albumin","0.15789473684210525"
"thrombosis_prediction","moderate","How many male patients have a normal level of both albumin and total protein?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'M' AND T2.ALB BETWEEN 3.5 AND 5.5 AND T2.TP BETWEEN 6.0 AND 8.5","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Male' AND T2.ALB BETWEEN 3.5 AND 5.0 AND T2.TP BETWEEN 6.0 AND 8.0;","0.8666666666666667"
"thrombosis_prediction","challenging","What is the anti Cardiolipin antibody concentration of the female patient with the highest uric acid level in the normal range?","SELECT T3.`aCL IgG`, T3.`aCL IgM`, T3.`aCL IgA` FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE T1.SEX = 'F' AND T2.UA > 6.5 ORDER BY T2.UA DESC LIMIT 1","SELECT T3.""aCL IgG"" FROM Examination AS T3 INNER JOIN Patient AS T1 ON T3.ID=T1.ID INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.SEX='Female' AND T2.UA BETWEEN 0 AND 7.0 ORDER BY T2.UA DESC LIMIT 1;","0.6190476190476191"
"thrombosis_prediction","moderate","What is the highest anti-nucleus antibody concentration level of a patient with a normal creatinine level?","SELECT T2.ANA FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID INNER JOIN Laboratory AS T3 ON T1.ID = T3.ID WHERE T3.CRE < 1.5 ORDER BY T2.ANA DESC LIMIT 1","SELECT MAX(T3.aCL IgG) AS Highest_aCL_IgG FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.CRE BETWEEN 0 AND 1;--Assuming normal creatinine level is between 0 and 1","0.45"
"thrombosis_prediction","moderate","Please list the patient's ID whose creatinine level is normal and whose anti Cardiolipin antibody concentration level is the highest.","SELECT T2.ID FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.CRE < 1.5 ORDER BY `aCL IgA` DESC LIMIT 1","SELECT P.ID FROM Patient P JOIN Laboratory L ON P.ID=L.ID JOIN Examination E ON P.ID=E.ID WHERE L.CRE BETWEEN 0.6 AND 1.2 ORDER BY E.aCL IgG DESC LIMIT 1;","0.3684210526315789"
"thrombosis_prediction","challenging","Among the patients whose total bilirubin is over the normal range, how many of them have a peripheral pattern observed in the sheet of ANA examination?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.`T-BIL` >= 2 AND T3.`ANA Pattern` LIKE '%P%'","SELECT COUNT(DISTINCT P.ID) FROM Patient AS P INNER JOIN Laboratory AS L ON P.ID=L.ID INNER JOIN Examination AS E ON P.ID=E.ID WHERE L.""T-BIL"">1.2 AND E.""ANA Pattern""='Peripheral';","0.5882352941176471"
"thrombosis_prediction","moderate","What is the anti-nucleus antibody concentration of the patient whose total bilirubin is the highest in the normal range?","SELECT T3.ANA FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.`T-BIL` < 2.0 ORDER BY T2.`T-BIL` DESC LIMIT 1","SELECT T3.aCL IgG, T3.aCL IgM FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.T-BIL=(SELECT MAX(T2_inner.T-BIL) FROM Laboratory AS T2_inner WHERE T2_inner.T-BIL<1.2)","0.6111111111111112"
"thrombosis_prediction","moderate","For the patients whose total cholesterol is higher than normal, how many of them have a negative measure of degree of coagulation?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.`T-CHO` >= 250 AND T3.KCT = '-'","SELECT COUNT(DISTINCT P.ID) FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.T-CHO>200 AND L.APTT<30;","0.3125"
"thrombosis_prediction","moderate","Among the patients whose total cholesterol is within the normal range, how many of them have a P pattern observed in the sheet of ANA examination?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T3.`ANA Pattern` = 'P' AND T2.`T-CHO` < 250","SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.T-CHO BETWEEN 125 AND 200 AND T3.""ANA Pattern"" LIKE '%P%';","0.8"
"thrombosis_prediction","simple","Among the patients with the normal level of triglyceride, how many of them have other symptoms observed?","SELECT COUNT(T1.ID) FROM Examination AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TG < 200 AND T1.Symptoms IS NOT NULL","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.TG BETWEEN 150 AND 200 AND T3.Symptoms IS NOT NULL;","0.7272727272727273"
"thrombosis_prediction","moderate","What is the disease name of the patient who has the highest level of triglyceride within the normal range?","SELECT T1.Diagnosis FROM Examination AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TG < 200 ORDER BY T2.TG DESC LIMIT 1","SELECT P.Diagnosis FROM Patient P JOIN Laboratory L ON P.ID=L.ID WHERE L.TG<=150 ORDER BY L.TG DESC LIMIT 1;","0.42857142857142855"
"thrombosis_prediction","simple","Please list the IDs of the patients with no thrombosis and an abnormal level of creatinine phosphokinase.","SELECT DISTINCT T1.ID FROM Laboratory AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.Thrombosis > 0 AND T1.CPK < 250","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T3.Thrombosis=0 AND T2.CPK>200;--Assuming 200 is the threshold for abnormal CPK level","0.4444444444444444"
"thrombosis_prediction","challenging","For the patients with a normal range of creatinine phosphokinase, how many of them have a positive measure of degree of coagulation?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.CPK < 250 AND (T3.KCT = '+' OR T3.RVVT = '+' OR T3.LAC = '+')","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.CPK BETWEEN 0 AND 200 AND T3.Thrombosis>0;","0.5333333333333333"
"thrombosis_prediction","simple","When is the birthday of the oldest patient whose blood glucose is abnormal?","SELECT T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GLU > 180 ORDER BY T1.Birthday ASC LIMIT 1","SELECT Birthday FROM Patient WHERE ID IN ( SELECT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.GLU>140--Assuming abnormal blood glucose is defined as greater than 140 mg/dL ) ORDER BY Birthday LIMIT 1;","0.4"
"thrombosis_prediction","moderate","Among the patients with a normal blood glucose, how many of them don't have thrombosis?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.GLU < 180 AND T3.Thrombosis = 0","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.GLU BETWEEN 70 AND 100 AND T3.Thrombosis=0;","0.7692307692307693"
"thrombosis_prediction","moderate","How many patients accepted to the hospital have a normal level of white blood cells?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.WBC BETWEEN 3.5 AND 9 AND T1.Admission = '+'","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T2.WBC BETWEEN 4.0 AND 11.0;","0.46153846153846156"
"thrombosis_prediction","simple","How many patients diagnosed with SLE have a normal white blood cell level?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Diagnosis = 'SLE' AND T2.WBC BETWEEN 3.5 AND 9","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.Diagnosis='SLE' AND T2.WBC BETWEEN 4 AND 11;","0.6153846153846154"
"thrombosis_prediction","challenging","Please list the patient's ID if he or she has an abnormal level of red blood cell and is followed at the outpatient clinic.","SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RBC <= 3.5 OR T2.RBC >= 6 AND T1.Admission = '-'","SELECT P.ID FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE L.RBC<4.5 OR L.RBC>6.0 AND P.Admission='Outpatient Clinic';","0.4375"
"thrombosis_prediction","moderate","Among the patients who have a normal platelet level, how many of them have other symptoms observed?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.PLT BETWEEN 100 AND 400 AND T1.Diagnosis IS NOT NULL","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.PLT BETWEEN 150 AND 450 AND T3.Symptoms IS NOT NULL;","0.42857142857142855"
"thrombosis_prediction","moderate","Please list a patient's platelet level if it is within the normal range and if he or she is diagnosed with MCTD.","SELECT T2.PLT FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Diagnosis = 'MCTD' AND T2.PLT BETWEEN 100 AND 400","SELECT T2.PLT FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID WHERE T1.Diagnosis='MCTD' AND T2.PLT BETWEEN 150 AND 450;","0.6666666666666666"
"thrombosis_prediction","simple","For the male patients that have a normal prothrombin time, what is their average prothrombin time?","SELECT AVG(T2.PT) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.PT < 14 AND T1.SEX = 'M'","SELECT AVG(L.TP) AS Average_Prothrombin_Time FROM Patient P INNER JOIN Laboratory L ON P.ID=L.ID WHERE P.SEX='Male' AND L.PT IS NOT NULL AND L.PT>=10 AND L.PT<=14;","0.4"
"thrombosis_prediction","moderate","How many patients with severe thrombosis have a normal prothrombin time?","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.PT < 14 AND T3.Thrombosis < 3 AND T3.Thrombosis > 0","SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID=T2.ID INNER JOIN Examination AS T3 ON T1.ID=T3.ID WHERE T2.PT>=14 AND T3.Thrombosis>=3;","0.9166666666666666"
"debit_card_specializing","simple","How many gas stations in CZE has Premium gas?","SELECT COUNT(GasStationID) FROM gasstations WHERE Country = 'CZE' AND Segment = 'Premium'","SELECT COUNT(*) FROM gasstations AS GS INNER JOIN transactions_1k AS T ON GS.GasStationID=T.GasStationID INNER JOIN products AS P ON T.ProductID=P.ProductID WHERE GS.Country='CZE' AND P.Description='Premium';","0.38461538461538464"
"debit_card_specializing","simple","What is the ratio of costumers who pay in EUR against customers who pay in CZK?","SELECT CAST(SUM(IIF(Currency = 'EUR', 1, 0)) AS FLOAT) / SUM(IIF(Currency = 'CZK', 1, 0)) FROM customers","SELECT (SELECT COUNT(*) FROM customers WHERE Currency='EUR')*1.0/(SELECT COUNT(*) FROM customers WHERE Currency='CZK') AS EUR_to_CZK_Ratio;","0.6666666666666666"
"debit_card_specializing","moderate","In 2012, who had the least consumption in LAM?","SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Segment = 'LAM' AND T2.date BETWEEN 201201 AND 201212 GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) ASC LIMIT 1","SELECT T.CustomerID, MIN(T.Consumption) AS LeastConsumption FROM yearmonth AS T WHERE T.Date BETWEEN 201201 AND 201212 GROUP BY T.CustomerID HAVING T.CustomerID IN (SELECT C.CustomerID FROM customers AS C WHERE C.Segment='LAM') ORDER BY LeastConsumption LIMIT 1;","0.6"
"debit_card_specializing","moderate","What was the average monthly consumption of customers in SME for the year 2013?","SELECT AVG(T2.Consumption) / 12 FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTRING(T2.Date, 1, 4) = '2013' AND T1.Segment = 'SME'","SELECT AVG(Consumption) AS AverageMonthlyConsumption FROM yearmonth WHERE CustomerID IN (SELECT CustomerID FROM customers WHERE Segment='SME') AND Date BETWEEN 201301 AND 201312;","0.375"
"debit_card_specializing","moderate","Which customers, paying in CZK, consumed the most gas in 2011?","SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1","SELECT C.CustomerID, SUM(YM.Consumption) AS TotalConsumption FROM customers C JOIN yearmonth YM ON C.CustomerID=YM.CustomerID JOIN transactions_1k T ON C.CustomerID=T.CustomerID WHERE C.Currency='CZK' AND YEAR(T.Date)=2011 GROUP BY C.CustomerID ORDER BY TotalConsumption DESC;","0.4117647058823529"
"debit_card_specializing","moderate","How many customers in KAM had a consumption of less than 30,000 for the year 2012?","SELECT COUNT(*) FROM ( SELECT T2.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Segment = 'KAM' AND SUBSTRING(T2.Date, 1, 4) = '2012' GROUP BY T2.CustomerID HAVING SUM(T2.Consumption) < 30000 ) AS t1","SELECT COUNT(DISTINCT C.CustomerID) FROM customers AS C JOIN yearmonth AS Y ON C.CustomerID=Y.CustomerID WHERE C.Segment='KAM' AND Y.Consumption<30000 AND strftime('%Y', Y.Date)='2012';","0.5"
"debit_card_specializing","challenging","What was the difference in gas consumption between CZK-paying customers and EUR-paying customers in 2012?","SELECT SUM(IIF(T1.Currency = 'CZK', T2.Consumption, 0)) - SUM(IIF(T1.Currency = 'EUR', T2.Consumption, 0)) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTRING(T2.Date, 1, 4) = '2012'","SELECT SUM(CASE WHEN C.Currency='CZK' THEN Y.Consumption ELSE 0 END) AS CZK_Consumption, SUM(CASE WHEN C.Currency='EUR' THEN Y.Consumption ELSE 0 END) AS EUR_Consumption, SUM(CASE WHEN C.Currency='CZK' THEN Y.Consumption ELSE 0 END)-SUM(CASE WHEN C.Currency='EUR' THEN Y.Consumption ELSE 0 END) AS Consumption_Difference FROM customers C JOIN yearmonth Y ON C.CustomerID=Y.CustomerID WHERE Y.Date BETWEEN 201201 AND 201212 GROUP BY C.Currency;","0.36363636363636365"
"debit_card_specializing","simple","Which year recorded the most gas use paid in EUR?","SELECT SUBSTRING(T2.Date, 1, 4) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'EUR' GROUP BY SUBSTRING(T2.Date, 1, 4) ORDER BY SUM(T2.Consumption) DESC LIMIT 1","SELECT strftime('%Y', T1.Date) AS Year, SUM(T1.Price*T1.Amount) AS TotalGasUse FROM transactions_1k AS T1 INNER JOIN customers AS C ON T1.CustomerID=C.CustomerID WHERE C.Currency='EUR' GROUP BY Year ORDER BY TotalGasUse DESC LIMIT 1;","0.35"
"debit_card_specializing","simple","Which segment had the least consumption?","SELECT T1.Segment FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID GROUP BY T1.Segment ORDER BY SUM(T2.Consumption) ASC LIMIT 1","SELECT Segment, SUM(Consumption) AS TotalConsumption FROM yearmonth AS Y INNER JOIN customers AS C ON Y.CustomerID=C.CustomerID GROUP BY Segment ORDER BY TotalConsumption ASC LIMIT 1;","0.5833333333333334"
"debit_card_specializing","moderate","Which year recorded the most consumption of gas paid in CZK?","SELECT SUBSTRING(T2.Date, 1, 4) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' GROUP BY SUBSTRING(T2.Date, 1, 4) ORDER BY SUM(T2.Consumption) DESC LIMIT 1","SELECT strftime('%Y', T.Date) AS Year, SUM(T.Amount*T.Price) AS TotalConsumption FROM transactions_1k AS T INNER JOIN customers AS C ON T.CustomerID=C.CustomerID WHERE C.Currency='CZK' GROUP BY Year ORDER BY TotalConsumption DESC LIMIT 1;","0.2857142857142857"
"debit_card_specializing","moderate","What was the gas consumption peak month for SME customers in 2013?","SELECT SUBSTRING(T2.Date, 5, 2) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTRING(T2.Date, 1, 4) = '2013' AND T1.Segment = 'SME' GROUP BY SUBSTRING(T2.Date, 5, 2) ORDER BY SUM(T2.Consumption) DESC LIMIT 1","SELECT strftime('%Y-%m', T2.Date) AS Month, SUM(T2.Consumption) AS TotalConsumption FROM yearmonth AS T2 INNER JOIN customers AS C ON T2.CustomerID=C.CustomerID WHERE C.Segment='SME' AND strftime('%Y', T2.Date)='2013' GROUP BY Month ORDER BY TotalConsumption DESC LIMIT 1;","0.47619047619047616"
"debit_card_specializing","challenging","What is the difference in the annual average consumption of the customers with the least amount of consumption paid in CZK for 2013 between SME and LAM, LAM and KAM, and KAM and SME?","SELECT CAST(SUM(IIF(T1.Segment = 'SME', T2.Consumption, 0)) AS FLOAT) / COUNT(T1.CustomerID) - CAST(SUM(IIF(T1.Segment = 'LAM', T2.Consumption, 0)) AS FLOAT) / COUNT(T1.CustomerID) , CAST(SUM(IIF(T1.Segment = 'LAM', T2.Consumption, 0)) AS FLOAT) / COUNT(T1.CustomerID) - CAST(SUM(IIF(T1.Segment = 'KAM', T2.Consumption, 0)) AS FLOAT) / COUNT(T1.CustomerID) , CAST(SUM(IIF(T1.Segment = 'KAM', T2.Consumption, 0)) AS FLOAT) / COUNT(T1.CustomerID) - CAST(SUM(IIF(T1.Segment = 'SME', T2.Consumption, 0)) AS FLOAT) / COUNT(T1.CustomerID) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Consumption = ( SELECT MIN(Consumption) FROM yearmonth ) AND T2.Date >= 201301","WITH AnnualConsumption AS ( SELECT C.Segment, C.CustomerID, SUM(YM.Consumption) AS TotalConsumption FROM customers C JOIN yearmonth YM ON C.CustomerID=YM.CustomerID WHERE YM.Date BETWEEN 201301 AND 201312 AND C.Currency='CZK' GROUP BY C.Segment, C.CustomerID ), LeastConsumption AS ( SELECT Segment, AVG(TotalConsumption) AS AvgConsumption FROM (SELECT Segment, TotalConsumption, ROW_NUMBER() OVER (PARTITION BY Segment ORDER BY TotalConsumption) AS rn FROM AnnualConsumption) AS Ranked WHERE rn=1 GROUP BY Segment ) SELECT A.Segment AS Segment1, B.Segment AS Segment2, A.AvgConsumption-B.AvgConsumption AS ConsumptionDifference FROM LeastConsumption A JOIN LeastConsumption B ON (A.Segment='SME' AND B.Segment='LAM') OR (A.Segment='LAM' AND B.Segment='KAM') OR (A.Segment='KAM' AND B.Segment='SME');","0.3055555555555556"
"debit_card_specializing","challenging","Which of the three segmentsSME, LAM and KAMhas the biggest and lowest percentage increases in consumption paid in EUR between 2012 and 2013?","SELECT CAST((SUM(IIF(T1.Segment = 'SME' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IIF(T1.Segment = 'SME' AND T2.Date LIKE '2012%', T2.Consumption, 0))) AS FLOAT) * 100 / SUM(IIF(T1.Segment = 'SME' AND T2.Date LIKE '2012%', T2.Consumption, 0)), CAST(SUM(IIF(T1.Segment = 'LAM' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IIF(T1.Segment = 'LAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) AS FLOAT) * 100 / SUM(IIF(T1.Segment = 'LAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) , CAST(SUM(IIF(T1.Segment = 'KAM' AND T2.Date LIKE '2013%', T2.Consumption, 0)) - SUM(IIF(T1.Segment = 'KAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) AS FLOAT) * 100 / SUM(IIF(T1.Segment = 'KAM' AND T2.Date LIKE '2012%', T2.Consumption, 0)) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID","WITH ConsumptionData AS ( SELECT C.Segment, SUM(CASE WHEN Y.Date=201201 THEN Y.Consumption ELSE 0 END) AS Consumption_2012, SUM(CASE WHEN Y.Date=201301 THEN Y.Consumption ELSE 0 END) AS Consumption_2013 FROM customers C JOIN yearmonth Y ON C.CustomerID=Y.CustomerID WHERE C.Currency='EUR' AND Y.Date IN (201201, 201301) GROUP BY C.Segment ), PercentageIncrease AS ( SELECT Segment, ((Consumption_2013-Consumption_2012)/NULLIF(Consumption_2012, 0))*100 AS PercentageIncrease FROM ConsumptionData ) SELECT Segment, PercentageIncrease FROM PercentageIncrease ORDER BY PercentageIncrease DESC LIMIT 1; SELECT Segment, PercentageIncrease FROM PercentageIncrease ORDER BY PercentageIncrease ASC LIMIT 1;","0.22580645161290322"
"debit_card_specializing","simple","How much did customer 6 consume in total between August and November 2013?","SELECT SUM(Consumption) FROM yearmonth WHERE CustomerID = 6 AND Date BETWEEN '201308' AND '201311'","SELECT SUM(T1.Amount) AS TotalConsumption FROM transactions_1k AS T1 WHERE T1.CustomerID=6 AND T1.Date BETWEEN '2013-08-01' AND '2013-11-30';","0.13333333333333333"
"debit_card_specializing","simple","How many more ""discount"" gas stations does the Czech Republic have compared to Slovakia?","SELECT SUM(IIF(Country = 'CZE', 1, 0)) - SUM(IIF(Country = 'SVK', 1, 0)) FROM gasstations WHERE Segment = 'Discount'","SELECT (SELECT COUNT(*) FROM gasstations WHERE Country='Czech Republic' AND Segment='discount')-(SELECT COUNT(*) FROM gasstations WHERE Country='Slovakia' AND Segment='discount') AS DiscountGasStationDifference;","0.3076923076923077"
"debit_card_specializing","simple","How much more was customer 7 consuming in April 2013 than customer 5?","SELECT SUM(IIF(CustomerID = 7, Consumption, 0)) - SUM(IIF(CustomerID = 5, Consumption, 0)) FROM yearmonth WHERE Date = '201304'","SELECT (SELECT Consumption FROM yearmonth WHERE CustomerID=7 AND Date=201304)-(SELECT Consumption FROM yearmonth WHERE CustomerID=5 AND Date=201304) AS ConsumptionDifference","0.6666666666666666"
"debit_card_specializing","simple","Is it true that more SMEs pay in Czech koruna than in euros? If so, how many more?","SELECT SUM(Currency = 'CZK') - SUM(Currency = 'EUR') FROM customers WHERE Segment = 'SME'","SELECT SUM(CASE WHEN C.Currency='CZK' THEN 1 ELSE 0 END) AS CountCZK, SUM(CASE WHEN C.Currency='EUR' THEN 1 ELSE 0 END) AS CountEUR, (SUM(CASE WHEN C.Currency='CZK' THEN 1 ELSE 0 END)-SUM(CASE WHEN C.Currency='EUR' THEN 1 ELSE 0 END)) AS Difference FROM customers C WHERE C.Segment='SME';","0.5"
"debit_card_specializing","moderate","Which LAM customer used the Euro as their currency and had the highest consumption in October 2013?","SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Segment = 'LAM' AND T2.Date = '201310' AND T1.Currency = 'EUR' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1","SELECT C.CustomerID, Y.Consumption FROM customers AS C INNER JOIN yearmonth AS Y ON C.CustomerID=Y.CustomerID WHERE C.Currency='Euro' AND Y.Date BETWEEN 20131001 AND 20131031 ORDER BY Y.Consumption DESC LIMIT 1;","0.3888888888888889"
"debit_card_specializing","simple","Who among KAM's customers consumed the most? How much did it consume?","SELECT T2.CustomerID, SUM(T2.Consumption) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Segment = 'KAM' GROUP BY T2.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1","SELECT C.CustomerID, SUM(Y.Consumption) AS TotalConsumption FROM customers AS C INNER JOIN yearmonth AS Y ON C.CustomerID=Y.CustomerID GROUP BY C.CustomerID ORDER BY TotalConsumption DESC LIMIT 1;","0.46153846153846156"
"debit_card_specializing","simple","How much did the KAM customers consume in total in May 2013?","SELECT SUM(T2.Consumption) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Date = '201305' AND T1.Segment = 'KAM'","SELECT SUM(T2.Consumption) AS TotalConsumption FROM yearmonth AS T2 INNER JOIN customers AS C ON T2.CustomerID=C.CustomerID WHERE C.Segment='KAM' AND T2.Date BETWEEN 20130501 AND 20130531;","0.5384615384615384"
"debit_card_specializing","moderate","How many percent of LAM customer consumed more than 46.73?","SELECT CAST(SUM(IIF(T2.Consumption > 46.73, 1, 0)) AS FLOAT) * 100 / COUNT(T1.CustomerID) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Segment = 'LAM'","SELECT (COUNT(CASE WHEN Y.Consumption>46.73 THEN 1 END)*100.0/COUNT(*)) AS Percentage FROM customers C JOIN yearmonth Y ON C.CustomerID=Y.CustomerID WHERE C.Segment='LAM';","0.6111111111111112"
"debit_card_specializing","simple","Which country has more ""value for money"" gas stations? Please give a total number of ""value for money"" gas stations in each country.","SELECT Country , ( SELECT COUNT(GasStationID) FROM gasstations WHERE Segment = 'Value for money' ) FROM gasstations WHERE Segment = 'Value for money' GROUP BY Country ORDER BY COUNT(GasStationID) DESC LIMIT 1","SELECT Country, COUNT(*) AS ValueForMoneyGasStations FROM gasstations WHERE Segment='value for money' GROUP BY Country ORDER BY ValueForMoneyGasStations DESC;","0.7"
"debit_card_specializing","simple","What percentage of KAM customers pay in euros?","SELECT CAST(SUM(Currency = 'EUR') AS FLOAT) * 100 / COUNT(CustomerID) FROM customers WHERE Segment = 'KAM'","SELECT (COUNT(CASE WHEN Currency='EUR' THEN 1 END)*100.0/COUNT(*)) AS Percentage_EUR_Customers FROM customers WHERE Segment='KAM';","0.5454545454545454"
"debit_card_specializing","simple","In February 2012, what percentage of customers consumed more than 528.3?","SELECT CAST(SUM(IIF(Consumption > 528.3, 1, 0)) AS FLOAT) * 100 / COUNT(CustomerID) FROM yearmonth WHERE Date = '201202'","SELECT (COUNT(CASE WHEN Y.Consumption>528.3 THEN 1 END)*100.0/COUNT(*)) AS Percentage FROM yearmonth AS Y WHERE Y.Date BETWEEN 20120201 AND 20120229;","0.4666666666666667"
"debit_card_specializing","simple","What percentage of Slovakian gas stations are premium?","SELECT CAST(SUM(IIF(Segment = 'Premium', 1, 0)) AS FLOAT) * 100 / COUNT(GasStationID) FROM gasstations WHERE Country = 'SVK'","SELECT (COUNT(CASE WHEN Segment='premium' THEN 1 END)*100.0/COUNT(*)) AS PremiumPercentage FROM gasstations WHERE Country='Slovakia';","0.5384615384615384"
"debit_card_specializing","simple","Which client ID consumed the most in September 2013?","SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Date = '201309' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) DESC LIMIT 1","SELECT CustomerID, SUM(Consumption) AS TotalConsumption FROM yearmonth WHERE Date BETWEEN 20130901 AND 20130930 GROUP BY CustomerID ORDER BY TotalConsumption DESC LIMIT 1;","0.4166666666666667"
"debit_card_specializing","simple","Which client segment consumed the least in September 2013?","SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Date = '201309' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) ASC LIMIT 1","SELECT c.Segment, SUM(ym.Consumption) AS TotalConsumption FROM customers AS c JOIN yearmonth AS ym ON c.CustomerID=ym.CustomerID WHERE ym.Date=201309 GROUP BY c.Segment ORDER BY TotalConsumption ASC LIMIT 1;","0.5384615384615384"
"debit_card_specializing","simple","Which SME customer consumed the least in June 2012?","SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Date = '201206' AND T1.Segment = 'SME' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) ASC LIMIT 1","SELECT C.CustomerID, SUM(YM.Consumption) AS TotalConsumption FROM customers C JOIN yearmonth YM ON C.CustomerID=YM.CustomerID WHERE C.Segment='SME' AND YM.Date BETWEEN 20120601 AND 20120630 GROUP BY C.CustomerID ORDER BY TotalConsumption ASC LIMIT 1;","0.5"
"debit_card_specializing","simple","What is the highest monthly consumption in the year 2012?","SELECT SUM(Consumption) FROM yearmonth WHERE SUBSTRING(Date, 1, 4) = '2012' GROUP BY SUBSTRING(Date, 5, 2) ORDER BY SUM(Consumption) DESC LIMIT 1","SELECT MAX(MonthlyConsumption) AS HighestMonthlyConsumption FROM ( SELECT strftime('%Y-%m', Date) AS YearMonth, SUM(Consumption) AS MonthlyConsumption FROM yearmonth WHERE Date>=201201 AND Date<201301 GROUP BY YearMonth ) AS MonthlyData;","0.11764705882352941"
"debit_card_specializing","simple","What is the biggest monthly consumption of the customers who use euro as their currency?","SELECT T2.Consumption FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'EUR' ORDER BY T2.Consumption DESC LIMIT 1","SELECT MAX(YM.Consumption) AS MaxMonthlyConsumption FROM yearmonth AS YM INNER JOIN customers AS C ON YM.CustomerID=C.CustomerID WHERE C.Currency='euro';","0.35714285714285715"
"debit_card_specializing","simple","Please list the product description of the products consumed in September, 2013.","SELECT T3.Description FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID INNER JOIN products AS T3 ON T1.ProductID = T3.ProductID WHERE T2.Date = '201309'","SELECT P.Description FROM transactions_1k AS T INNER JOIN products AS P ON T.ProductID=P.ProductID WHERE T.Date>='2013-09-01' AND T.Date<'2013-10-01';","0.25"
"debit_card_specializing","moderate","Please list the countries of the gas stations with transactions taken place in June, 2013.","SELECT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN yearmonth AS T3 ON T1.CustomerID = T3.CustomerID WHERE T3.Date = '201306'","SELECT DISTINCT G.Country FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID WHERE T.Date>='2013-06-01' AND T.Date<'2013-07-01';","0.25"
"debit_card_specializing","simple","Please list the chains of the gas stations with transactions in euro.","SELECT DISTINCT T3.ChainID FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID INNER JOIN gasstations AS T3 ON T1.GasStationID = T3.GasStationID WHERE T2.Currency = 'EUR'","SELECT DISTINCT G.ChainID FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID INNER JOIN customers AS C ON T.CustomerID=C.CustomerID WHERE C.Currency='euro';","0.4666666666666667"
"debit_card_specializing","simple","Please list the product description of the products bought in transactions in euro.","SELECT DISTINCT T1.ProductID, T3.Description FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID INNER JOIN products AS T3 ON T1.ProductID = T3.ProductID WHERE T2.Currency = 'EUR'","SELECT P.Description FROM transactions_1k AS T INNER JOIN products AS P ON T.ProductID=P.ProductID INNER JOIN customers AS C ON T.CustomerID=C.CustomerID WHERE C.Currency='euro';","0.4666666666666667"
"debit_card_specializing","simple","What is the average total price of the transactions taken place in January, 2012?","SELECT AVG(Amount) FROM transactions_1k WHERE Date LIKE '2012-01%'","SELECT AVG(T1.Price*T1.Amount) AS AverageTotalPrice FROM transactions_1k AS T1 WHERE T1.Date>='2012-01-01' AND T1.Date<'2012-02-01';","0.5"
"debit_card_specializing","simple","Among the customers who paid in euro, how many of them have a monthly consumption of over 1000?","SELECT COUNT(*) FROM yearmonth AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Currency = 'EUR' AND T1.Consumption > 1000.00","SELECT COUNT(DISTINCT C.CustomerID) FROM customers AS C JOIN yearmonth AS Y ON C.CustomerID=Y.CustomerID WHERE C.Currency='euro' AND Y.Consumption>1000;","0.46153846153846156"
"debit_card_specializing","moderate","Please list the product descriptions of the transactions taken place in the gas stations in the Czech Republic.","SELECT T3.Description FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN products AS T3 ON T1.ProductID = T3.ProductID WHERE T2.Country = 'CZE'","SELECT P.Description FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID INNER JOIN products AS P ON T.ProductID=P.ProductID WHERE G.Country='Czech Republic';","0.4375"
"debit_card_specializing","simple","Please list the disparate time of the transactions taken place in the gas stations from chain no. 11.","SELECT DISTINCT T1.Date, T1.Time FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T2.ChainID = 11","SELECT DISTINCT T.Time FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID WHERE G.ChainID=11;","0.6"
"debit_card_specializing","simple","How many transactions taken place in the gas station in the Czech Republic are with a price of over 1000?","SELECT COUNT(T1.TransactionID) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T2.Country = 'CZE' AND T1.Price > 1000","SELECT COUNT(*) AS TransactionCount FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID WHERE G.Country='Czech Republic' AND T.Price>1000;","0.4"
"debit_card_specializing","moderate","Among the transactions made in the gas stations in the Czech Republic, how many of them are taken place after 2012/1/1?","SELECT COUNT(T1.TransactionID) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T2.Country = 'CZE' AND strftime('%Y', T1.Date) >= 2012","SELECT COUNT(*) FROM transactions_1k AS T1 INNER JOIN gasstations AS G ON T1.GasStationID=G.GasStationID WHERE G.Country='Czech Republic' AND T1.Date>'2012-01-01';","0.4"
"debit_card_specializing","simple","What is the average total price of the transactions taken place in gas stations in the Czech Republic?","SELECT AVG(T1.Price) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T2.Country = 'CZE'","SELECT AVG(T1.Price*T1.Amount) AS AverageTotalPrice FROM transactions_1k AS T1 INNER JOIN gasstations AS G ON T1.GasStationID=G.GasStationID WHERE G.Country='Czech Republic';","0.46153846153846156"
"debit_card_specializing","simple","For the customers who paid in the euro, what is their average total price of the transactions?","SELECT AVG(T1.Price) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN customers AS T3 ON T1.CustomerID = T3.CustomerID WHERE T3.Currency = 'EUR'","SELECT AVG(T1.Price) AS AverageTotalPrice FROM transactions_1k AS T1 INNER JOIN customers AS C ON T1.CustomerID=C.CustomerID WHERE C.Currency='euro';","0.42857142857142855"
"debit_card_specializing","simple","Which customer paid the most in 2012/8/25?","SELECT CustomerID FROM transactions_1k WHERE Date = '2012-08-25' GROUP BY CustomerID ORDER BY SUM(Price) DESC LIMIT 1","SELECT T1.CustomerID, SUM(T1.Price*T1.Amount) AS TotalPaid FROM transactions_1k AS T1 WHERE T1.Date='2012-08-25' GROUP BY T1.CustomerID ORDER BY TotalPaid DESC LIMIT 1;","0.7272727272727273"
"debit_card_specializing","simple","Which country's gas station had the first paid cusomer in 2012/8/25?","SELECT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-25' ORDER BY T1.Time DESC LIMIT 1","SELECT G.Country FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID WHERE T.Date='2012-08-25' ORDER BY T.TransactionID LIMIT 1;","0.5333333333333333"
"debit_card_specializing","simple","What kind of currency did the customer paid at 16:25:00 in 2012/8/24?","SELECT T3.Currency FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN customers AS T3 ON T1.CustomerID = T3.CustomerID WHERE T1.Date = '2012-08-24' AND T1.Time = '16:25:00'","SELECT C.Currency FROM transactions_1k AS T INNER JOIN customers AS C ON T.CustomerID=C.CustomerID WHERE T.Date='2012-08-24' AND T.Time='16:25:00';","0.6111111111111112"
"debit_card_specializing","simple","What segment did the customer have at 2012/8/23 21:20:00?","SELECT T2.Segment FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.date = '2012-08-23' AND T1.time = '21:20:00'","SELECT Segment FROM customers WHERE CustomerID=(SELECT CustomerID FROM transactions_1k WHERE Date='2012-08-23' AND Time='21:20:00');","0.8461538461538461"
"debit_card_specializing","moderate","How many transactions were paid in EUR in the morning of 2012/8/26?","SELECT COUNT(T1.TransactionID) FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Date = '2012-08-26' AND T1.Time < '13:00:00' AND T2.Currency = 'EUR'","SELECT COUNT(*) FROM transactions_1k WHERE Date='2012-08-26' AND Time BETWEEN '00:00:00' AND '11:59:59' AND CustomerID IN (SELECT CustomerID FROM customers WHERE Currency='EUR');","0.625"
"debit_card_specializing","simple","For the earliest customer, what segment did he/she have?","SELECT T2.Segment FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID ORDER BY Date ASC LIMIT 1","SELECT Segment FROM customers WHERE CustomerID=(SELECT CustomerID FROM yearmonth ORDER BY Date ASC LIMIT 1);","0.5555555555555556"
"debit_card_specializing","simple","For the deal happened at 2012/8/24 12:42:00, which country was it?","SELECT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-24' AND T1.Time = '12:42:00'","SELECT GS.Country FROM transactions_1k AS T INNER JOIN gasstations AS GS ON T.GasStationID=GS.GasStationID WHERE T.Date='2012-08-24' AND T.Time='12:42:00';","0.7333333333333333"
"debit_card_specializing","simple","What was the product name of the transaction happened at 2012/8/23 21:20:00?","SELECT T1.ProductID FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-23' AND T1.Time = '21:20:00'","SELECT P.Description FROM transactions_1k AS T INNER JOIN products AS P ON T.ProductID=P.ProductID WHERE T.Date='2012-08-23' AND T.Time='21:20:00';","0.5294117647058824"
"debit_card_specializing","moderate","For the customer who paid 124.05 in 2012/8/24, how much did he/she spend during the January of 2012? And what is the date and expenses exactly?","SELECT T1.CustomerID, T2.Date, T2.Consumption FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Date = '2012-08-24' AND T1.Price = 124.05 AND T2.Date = '201201'","SELECT T1.Date, SUM(T1.Price) AS TotalSpent FROM transactions_1k AS T1 INNER JOIN customers AS C ON T1.CustomerID=C.CustomerID WHERE T1.CustomerID IN ( SELECT CustomerID FROM transactions_1k WHERE Date='2012-08-24' AND Price=124.05 ) AND T1.Date>='2012-01-01' AND T1.Date<'2012-02-01' GROUP BY T1.Date;","0.5"
"debit_card_specializing","moderate","For all the transactions happened during 8:00-9:00 in 2012/8/26, how many happened in CZE?","SELECT COUNT(T1.TransactionID) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-26' AND T1.Time BETWEEN '08:00:00' AND '09:00:00' AND T2.Country = 'CZE'","SELECT COUNT(*) FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID WHERE T.Date='2012-08-26' AND T.Time BETWEEN '08:00:00' AND '09:00:00' AND G.Country='CZE';","0.6875"
"debit_card_specializing","simple","There's one customer spent 214582.17 in the June of 2013, which currency did he/she use?","SELECT T2.Currency FROM yearmonth AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Date = '201306' AND T1.Consumption = 214582.17","SELECT C.Currency FROM customers AS C INNER JOIN transactions_1k AS T ON C.CustomerID=T.CustomerID WHERE T.Amount=214582.17 AND T.Date>='2013-06-01' AND T.Date<'2013-07-01';","0.2777777777777778"
"debit_card_specializing","simple","Which country was the card owner of No.667467 in?","SELECT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.CardID = '667467'","SELECT G.Country FROM transactions_1k AS T INNER JOIN gasstations AS G ON T.GasStationID=G.GasStationID WHERE T.CardID=667467;","0.6"
"debit_card_specializing","simple","What's the nationality of the customer who spent 548.4 in 2012/8/24?","SELECT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-24' AND T1.Price = 548.4","SELECT C.Currency FROM customers AS C INNER JOIN transactions_1k AS T ON C.CustomerID=T.CustomerID WHERE T.Amount=548.4 AND T.Date='2012-08-24';","0.3333333333333333"
"debit_card_specializing","simple","What is the percentage of the customers who used EUR in 2012/8/25?","SELECT CAST(SUM(IIF(T2.Currency = 'EUR', 1, 0)) AS FLOAT) * 100 / COUNT(T1.CustomerID) FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Date = '2012-08-25'","SELECT (COUNT(CASE WHEN C.Currency='EUR' THEN 1 END)*100.0/COUNT(*)) AS Percentage_EUR_Customers FROM customers AS C JOIN transactions_1k AS T ON C.CustomerID=T.CustomerID WHERE T.Date='2012-08-25';","0.6111111111111112"
"debit_card_specializing","challenging","For the customer who paid 634.8 in 2012/8/25, what was the consumption decrease rate from Year 2012 to 2013?","SELECT CAST(SUM(IIF(SUBSTRING(Date, 1, 4) = '2012', Consumption, 0)) - SUM(IIF(SUBSTRING(Date, 1, 4) = '2013', Consumption, 0)) AS FLOAT) / SUM(IIF(SUBSTRING(Date, 1, 4) = '2012', Consumption, 0)) FROM yearmonth WHERE CustomerID = ( SELECT T1.CustomerID FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-25' AND T1.Price = 634.8 )","SELECT (SUM(CASE WHEN strftime('%Y', T2.Date)='2012' THEN T2.Consumption ELSE 0 END)-SUM(CASE WHEN strftime('%Y', T2.Date)='2013' THEN T2.Consumption ELSE 0 END))/SUM(CASE WHEN strftime('%Y', T2.Date)='2012' THEN T2.Consumption ELSE 0 END)*100 AS ConsumptionDecreaseRate FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID=T2.CustomerID WHERE T1.Date='2012-08-25' AND T1.Price/T1.Amount=634.8;","0.5384615384615384"
"debit_card_specializing","simple","Which gas station has the highest amount of revenue?","SELECT GasStationID FROM transactions_1k GROUP BY GasStationID ORDER BY SUM(Price) DESC LIMIT 1","SELECT GS.GasStationID, SUM(T.Amount*T.Price) AS TotalRevenue FROM transactions_1k AS T INNER JOIN gasstations AS GS ON T.GasStationID=GS.GasStationID GROUP BY GS.GasStationID ORDER BY TotalRevenue DESC LIMIT 1;","0.5"
"debit_card_specializing","simple","What is the percentage of ""premium"" against the overall segment in ""SVK""?","SELECT CAST(SUM(IIF(Country = 'SVK' AND Segment = 'Premium', 1, 0)) AS FLOAT) * 100 / COUNT(GasStationID) FROM gasstations","SELECT (COUNT(CASE WHEN g.Segment='premium' THEN 1 END)*100.0/COUNT(*)) AS premium_percentage FROM gasstations g WHERE g.Country='SVK';","0.6153846153846154"
"debit_card_specializing","moderate","What is the amount spent by customer ""38508"" at the gas stations? How much had the customer spent in January 2012?","SELECT SUM(T1.Price) , SUM(IIF(T3.Date = '201201', T1.Price, 0)) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN yearmonth AS T3 ON T1.CustomerID = T3.CustomerID WHERE T1.CustomerID = '38508'","SELECT SUM(T1.Amount) AS TotalSpent FROM transactions_1k AS T1 WHERE T1.CustomerID=38508 AND T1.GasStationID IN (SELECT GasStationID FROM gasstations) UNION ALL SELECT SUM(T1.Amount) AS TotalSpentJanuary2012 FROM transactions_1k AS T1 WHERE T1.CustomerID=38508 AND T1.Date>='2012-01-01' AND T1.Date<'2012-02-01' AND T1.GasStationID IN (SELECT GasStationID FROM gasstations);","0.3157894736842105"
"debit_card_specializing","simple","Which are the top five best selling products? Please state the full name of them.","SELECT T2.Description FROM transactions_1k AS T1 INNER JOIN products AS T2 ON T1.ProductID = T2.ProductID ORDER BY T1.Amount DESC LIMIT 5","SELECT P.Description, SUM(T.Amount) AS TotalSold FROM transactions_1k AS T INNER JOIN products AS P ON T.ProductID=P.ProductID GROUP BY P.Description ORDER BY TotalSold DESC LIMIT 5;","0.5833333333333334"
"debit_card_specializing","moderate","Who is the top spending customer and how much is the average price per single item purchased by this customer? What currency was being used?","SELECT T2.CustomerID, SUM(T2.Price / T2.Amount), T1.Currency FROM customers AS T1 INNER JOIN transactions_1k AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.CustomerID = ( SELECT CustomerID FROM yearmonth ORDER BY Consumption DESC LIMIT 1 ) GROUP BY T2.CustomerID, T1.Currency","SELECT C.CustomerID, C.Currency, SUM(T.Price*T.Amount) AS TotalSpent, AVG(T.Price) AS AveragePricePerItem FROM transactions_1k T INNER JOIN customers C ON T.CustomerID=C.CustomerID GROUP BY C.CustomerID, C.Currency ORDER BY TotalSpent DESC LIMIT 1;","0.5"
"debit_card_specializing","simple","Which country had the gas station that sold the most expensive product id No.2 for one unit?","SELECT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.ProductID = 2 ORDER BY T1.Price DESC LIMIT 1","SELECT g.Country, MAX(t.Price) AS MaxPrice FROM transactions_1k AS t INNER JOIN gasstations AS g ON t.GasStationID=g.GasStationID WHERE t.ProductID=2 GROUP BY g.Country ORDER BY MaxPrice DESC LIMIT 1;","0.6428571428571429"
"debit_card_specializing","moderate","For all the people who paid more than 29.00 per unit of product id No.5. Give their consumption status in the August of 2012.","SELECT T2.CustomerID, T2.Consumption FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Price / T1.Amount > 29.00 AND T1.ProductID = 5 AND T2.Date = '201208'","SELECT T2.CustomerID, T2.Consumption FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID=T2.CustomerID WHERE T1.Price/T1.Amount>29.00 AND T1.ProductID=5 AND T2.Date=201208;","1.0"
